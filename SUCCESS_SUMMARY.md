# ‚úÖ –£—Å–ø–µ—à–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

## –°—Ç–∞—Ç—É—Å
**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç!** üéâ

–í –ª–æ–≥–∞—Ö –≤–∏–¥–Ω–æ —É—Å–ø–µ—à–Ω—É—é –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é:
```
POST /api/social-auth/telegram/auth/ HTTP/2.0" 200 495
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω: id=21, username=Mr_Fulani_Dev
–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞: user=Mr_Fulani_Dev
Response —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ
```

## –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ RawPostDataException ‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞:** `You cannot access body after reading from request's data stream`
**–†–µ—à–µ–Ω–∏–µ:** 
- –£–±—Ä–∞–Ω—ã –≤—Å–µ –ø—Ä—è–º—ã–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ `request.body`
- –ò–∑–º–µ–Ω–µ–Ω –ø–æ—Ä—è–¥–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏: —Å–Ω–∞—á–∞–ª–∞ `request.data`, –ø–æ—Ç–æ–º `request.POST`, –ø–æ—Ç–æ–º `_body`
- –ó–∞–º–µ–Ω–µ–Ω—ã –≤—Å–µ `request.body` –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —á—Ç–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `request._body`

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ hash fragment ‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞:** Telegram –ø–µ—Ä–µ–¥–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ `#tgAuthResult=base64_json`
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ hash fragment –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ

### 3. –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ ‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–∏–º–æ–ª–µ—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
**–†–µ—à–µ–Ω–∏–µ:**
- –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON
- –£–±—Ä–∞–Ω—ã alert –¥–ª—è –º–∏–º–æ–ª–µ—Ç–Ω—ã—Ö –æ—à–∏–±–æ–∫
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø–∞—Ä—Å–∏–Ω–≥–∞

## –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
cd /opt/quiz_project/quiz_project
git pull origin fix/telegram-auth-issue

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å quiz_backend
docker compose -f docker-compose.local-prod.yml up -d --build quiz_backend
```

## –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

1. **–ñ–µ—Å—Ç–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ**: `Ctrl + Shift + R` (–∏–ª–∏ `Cmd + Shift + R` –Ω–∞ Mac)
2. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ Telegram
3. –î–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫!

## –ß—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ –ª–æ–≥–∞—Ö

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
–î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã –∏–∑ request.data (DRF): {...}
–û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏: {...}
–î–∞–Ω–Ω—ã–µ –ø—Ä–æ—à–ª–∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é: {...}
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω: id=..., username=...
–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞: user=...
Response —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ
POST /api/social-auth/telegram/auth/ HTTP/2.0" 200
```

## –ï—Å–ª–∏ –≤—Å–µ –µ—â–µ –µ—Å—Ç—å –º–∏–º–æ–ª–µ—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏

–û–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É–±—Ä–∞–Ω—ã –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞. –ï—Å–ª–∏ –æ—Å—Ç–∞–ª–∏—Å—å:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–µ—Ä–µ—Å–æ–±—Ä–∞–ª—Å—è
2. –°–¥–µ–ª–∞–π—Ç–µ –∂–µ—Å—Ç–∫—É—é –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ
3. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞

## –í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –≤–µ—Ç–∫–µ `fix/telegram-auth-issue`

