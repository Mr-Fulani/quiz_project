<!DOCTYPE html>
{% load static i18n blog_tags %}
{% get_current_language as language %}
<html lang="{{ language }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{{ dynamic_seo.meta_title|default:meta_title|default:"QuizHub - Programming Quizzes & Learning" }}{% endblock %}</title>
    
    <!-- Basic Meta Tags -->
    <meta name="description" content="{% block meta_description %}{{ dynamic_seo.meta_description|default:meta_description|truncatechars:160|default:'Master programming with interactive quizzes and tutorials.' }}{% endblock %}">
    <meta name="keywords" content="{% block meta_keywords %}{{ dynamic_seo.meta_keywords|default:meta_keywords|default:'programming quiz, coding challenges, learning platform' }}{% endblock %}">
    <meta name="author" content="{{ meta_author|default:'Anvar Sh.' }}">
    <meta name="copyright" content="{{ meta_copyright }}">
    <meta name="rating" content="{{ meta_rating|default:'general' }}">
    <meta name="distribution" content="{{ meta_distribution|default:'global' }}">
    <meta name="revisit-after" content="{{ meta_revisit_after|default:'7 days' }}">
    <meta name="robots" content="{% block meta_robots %}{{ dynamic_seo.robots_content|default:robots_content|default:'index, follow' }}{% endblock %}">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="{% block canonical_url %}{{ dynamic_seo.canonical_url|default:canonical_url }}{% endblock %}">
    
    <!-- Hreflang Tags -->
    {% if hreflang_en %}<link rel="alternate" hreflang="en" href="{{ hreflang_en }}">{% endif %}
    {% if hreflang_ru %}<link rel="alternate" hreflang="ru" href="{{ hreflang_ru }}">{% endif %}
    {% if hreflang_x_default %}<link rel="alternate" hreflang="x-default" href="{{ hreflang_x_default }}">{% endif %}
    
    <!-- Open Graph Tags -->
    <meta property="og:title" content="{% block og_title %}{{ dynamic_seo.og_title|default:og_title|default:'QuizHub - Programming Quizzes' }}{% endblock %}">
    <meta property="og:description" content="{% block og_description %}{{ dynamic_seo.og_description|default:og_description|truncatechars:200|default:'Master programming with interactive quizzes and tutorials.' }}{% endblock %}">
    <meta property="og:image" content="{% block og_image %}{{ dynamic_seo.og_image|default:og_image|default:'/static/blog/images/default-og-image.jpeg' }}{% endblock %}">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:type" content="image/jpeg">

    <meta property="og:url" content="{% block og_url %}{{ dynamic_seo.og_url|default:og_url }}{% endblock %}">
    <meta property="og:type" content="{% block og_type %}{{ dynamic_seo.og_type|default:'website' }}{% endblock %}">
    <meta property="og:site_name" content="{{ og_site_name|default:'QuizHub' }}">
    <meta property="og:locale" content="{{ og_locale|default:'en_US' }}">
    

    
    <!-- Article specific OG tags (for blog posts) -->
    {% if dynamic_seo.article_author %}<meta property="article:author" content="{{ dynamic_seo.article_author }}">{% endif %}
    {% if dynamic_seo.article_published_time %}<meta property="article:published_time" content="{{ dynamic_seo.article_published_time }}">{% endif %}
    {% if dynamic_seo.article_modified_time %}<meta property="article:modified_time" content="{{ dynamic_seo.article_modified_time }}">{% endif %}
    {% if dynamic_seo.article_section %}<meta property="article:section" content="{{ dynamic_seo.article_section }}">{% endif %}
    {% if dynamic_seo.article_tag %}
        {% for tag in dynamic_seo.article_tag %}
            <meta property="article:tag" content="{{ tag }}">
        {% endfor %}
    {% endif %}
    
    <!-- Twitter Card Tags -->
    <meta name="twitter:card" content="{{ twitter_card|default:'summary_large_image' }}">
    <meta name="twitter:site" content="{{ twitter_site|default:'@quiz_code_hub' }}">
    <meta name="twitter:creator" content="{{ twitter_creator|default:'@mr_fulani' }}">
    <meta name="twitter:title" content="{% block twitter_title %}{{ dynamic_seo.twitter_title|default:twitter_title|default:'QuizHub - Programming Quizzes' }}{% endblock %}">
    <meta name="twitter:description" content="{% block twitter_description %}{{ dynamic_seo.twitter_description|default:twitter_description|truncatechars:200|default:'Master programming with interactive quizzes and tutorials.' }}{% endblock %}">
    <meta name="twitter:image" content="{% block twitter_image %}{{ dynamic_seo.twitter_image|default:twitter_image|default:'/static/blog/images/default-og-image.jpeg' }}{% endblock %}">

    
    <!-- VK Meta Tags -->
    <meta property="vk:title" content="{{ dynamic_seo.vk_title|default:'QuizHub - Programming Quizzes' }}">
    <meta property="vk:description" content="{{ dynamic_seo.vk_description|default:'Master programming with interactive quizzes and tutorials.' }}">
    <meta property="vk:image" content="{{ dynamic_seo.vk_image|default:'/static/blog/images/default-og-image.jpeg' }}">
    

    

    

    
    <!-- Mobile and App Meta Tags -->
    <meta name="theme-color" content="#1a1a2e">
    <meta name="msapplication-TileColor" content="#1a1a2e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="QuizHub">
    
    <!-- Telegram Mini App specific -->
    {% if is_mini_app %}
        <meta name="telegram-mini-app" content="true">
        <!-- –î–ª—è Telegram Mini App –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è, –Ω–æ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CSS –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
    {% endif %}

    <!-- Preconnect –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –≤–Ω–µ—à–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ -->
    <link rel="preconnect" href="https://oauth.telegram.org" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Favicon -->
    <link rel="icon" href="{% static 'blog/favicon/favicon.png' %}" type="image/png">
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'blog/favicon/favicon.png' %}">
    {# –î–ª—è –ª—É—á—à–µ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∏–∫–æ–Ω–∫–∏ –¥—Ä—É–≥–∏—Ö —Ä–∞–∑–º–µ—Ä–æ–≤, –Ω–∞–ø—Ä–∏–º–µ—Ä: #}
    {# <link rel="icon" type="image/png" sizes="32x32" href="{% static 'path/to/favicon-32x32.png' %}"> #}
    {# <link rel="icon" type="image/png" sizes="16x16" href="{% static 'path/to/favicon-16x16.png' %}"> #}
    {# <link rel="manifest" href="{% static 'path/to/site.webmanifest' %}"> #}
    {# <link rel="mask-icon" href="{% static 'path/to/safari-pinned-tab.svg' %}" color="#5bbad5"> #}

    <!-- CSS —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è FOUC -->
    <link rel="stylesheet" href="{% static_versioned 'blog/css/global.css' %}">
    <link rel="stylesheet" href="{% static_versioned 'blog/css/header-spacing.css' %}">
    <link rel="stylesheet" href="{% static_versioned 'blog/css/animated_auth.css' %}">
    <link rel="stylesheet" href="{% static_versioned 'blog/css/cookie-consent.css' %}">
    {% block extra_css %}{% endblock %}

    <script type="module" src="{% static 'blog/js/ionicons/ionicons.esm.js' %}" defer></script>
    <script nomodule src="{% static 'blog/js/ionicons/ionicons.js' %}" defer></script>
    
    <!-- –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ –≤ –∫–æ–Ω–µ—Ü body –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è render-blocking) -->

    <!-- Preload Font Awesome –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ -->
    <link rel="preload" href="{% static 'blog/webfonts/fa-solid-900.woff2' %}" as="font" type="font/woff2" crossorigin>
    <link rel="stylesheet" href="{% static_versioned 'blog/css/font-awesome.min.css' %}">
    <script src="{% static_versioned 'blog/js/font-awesome.min.js' %}" defer></script>
    <!-- Font Awesome —É–∂–µ –∏–º–µ–µ—Ç font-display –≤ CSS, preload —É—Å–∫–æ—Ä—è–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É -->
    
    <!-- Highlight.js –¥–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –∫–æ–¥–∞ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/vs2015.min.css" crossorigin="anonymous" referrerpolicy="no-referrer">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" crossorigin="anonymous" referrerpolicy="no-referrer" defer></script>
    <!-- –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–ª—å–∫–æ –æ—Å–Ω–æ–≤–Ω—ã–µ —è–∑—ã–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ç–æ—á–Ω–æ —Å—É—â–µ—Å—Ç–≤—É—é—Ç -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/python.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/javascript.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/typescript.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/java.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/cpp.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/json.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/bash.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/sql.min.js" defer></script>
    <!-- CSS, HTML –∏ –¥—Ä—É–≥–∏–µ —è–∑—ã–∫–∏ –≤—Å—Ç—Ä–æ–µ–Ω—ã –≤ –æ—Å–Ω–æ–≤–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É -->

    <!-- GSAP –±—É–¥–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω –≤ —Ñ—É—Ç–µ—Ä–µ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ –ø—á–µ–ª—ã -->

    {% block extra_head %}
    {# Chart.js –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –Ω–µ –≥–ª–æ–±–∞–ª—å–Ω–æ #}
    {% endblock %}

    <!-- Analytics IDs - –ø–µ—Ä–µ–¥–∞–µ–º –≤ JavaScript –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Å–æ–≥–ª–∞—Å–∏—è -->
    {% if GOOGLE_ANALYTICS_PROPERTY_ID %}
        <script>
            // –ü–µ—Ä–µ–¥–∞–µ–º ID Google Analytics –≤ JavaScript –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å–ª–µ —Å–æ–≥–ª–∞—Å–∏—è
            window.GOOGLE_ANALYTICS_PROPERTY_ID = '{{ GOOGLE_ANALYTICS_PROPERTY_ID }}';
        </script>
    {% endif %}

    {% if YANDEX_METRICA_ID %}
        <script>
            // –ü–µ—Ä–µ–¥–∞–µ–º ID Yandex Metrika –≤ JavaScript –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å–ª–µ —Å–æ–≥–ª–∞—Å–∏—è
            window.YANDEX_METRICA_ID = '{{ YANDEX_METRICA_ID }}';
        </script>
    {% endif %}

    <!-- Cookie Consent - –∑–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–º —Ç–µ–≥–æ–º body -->
    <script>
        // –ü–µ—Ä–µ–¥–∞–µ–º URL Privacy Policy –¥–ª—è cookie consent banner
        window.COOKIE_CONSENT_PRIVACY_URL = '{% url "blog:privacy_policy" %}';
    </script>
 

    <!-- Structured Data (JSON-LD) -->
    {% if website_json_ld %}
        <script type="application/ld+json">
            {{ website_json_ld | safe }}
        </script>
    {% endif %}
    
    {% if organization_json_ld %}
        <script type="application/ld+json">
            {{ organization_json_ld | safe }}
        </script>
    {% endif %}
    
    {% if dynamic_seo.article_json_ld %}
        <script type="application/ld+json">
            {{ dynamic_seo.article_json_ld | safe }}
        </script>
    {% endif %}
    
    {% if dynamic_seo.project_json_ld %}
        <script type="application/ld+json">
            {{ dynamic_seo.project_json_ld | safe }}
        </script>
    {% endif %}
    
    {% if webapp_json_ld %}
        <script type="application/ld+json">
            {{ webapp_json_ld | safe }}
        </script>
    {% endif %}
    
    <!-- Structured data for breadcrumbs (BreadcrumbList) -->
    {% if breadcrumbs_json_ld %}
        <script type="application/ld+json">
            {{ breadcrumbs_json_ld | safe }}
        </script>
    {% endif %}




</head>
<body data-authenticated="{% if user.is_authenticated %}true{% else %}false{% endif %}">
<main>
    {% block sidebar %}
    {% include 'accounts/sidebar.html' %}
    {% endblock %}

    <div class="main-content">
        <nav class="navbar">
            <ul class="navbar-list">
                <li class="navbar-item">
                    <a href="{% url 'blog:home' %}" class="navbar-link home-link" title="{% trans 'Home' %}">
                        <i class="fas fa-home"></i>
                        <span class="nav-text">{% trans "Home" %}</span>
                    </a>
                </li>
                <li class="navbar-item"><a href="{% url 'blog:blog' %}" class="navbar-link">{% trans "Posts" %}</a></li>
                <li class="navbar-item"><a href="{% url 'blog:quizes' %}" class="navbar-link">{% trans "Quizzes" %}</a></li>
                <li class="navbar-item"><a href="{% url 'donation:donation_page' %}" class="navbar-link">{% trans "Donate" %}</a></li>
                {% if user.is_authenticated %}
                <li class="navbar-item"><a href="{% url 'accounts:user-list' %}" class="navbar-link">{% trans "Users" %}</a></li>
                <li class="navbar-item"><a href="{% url 'accounts:profile' %}" class="navbar-link">{% trans "Profile" %}</a></li>
                {% else %}
                <li class="navbar-item"><a href="#" id="login-link" class="navbar-link">{% trans "Login" %}</a></li>
                {% endif %}
                <!-- –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —è–∑—ã–∫–∞ -->
                <li class="nav-item">
                    <div class="language-switcher-globe">
                        <div class="globe-icon" id="globe-toggle">
                            <i class="fas fa-globe"></i>
                        </div>
                        <div class="language-dropdown" id="language-dropdown">
                            <button type="button" class="language-option {% if LANGUAGE_CODE == 'en' %}active{% endif %}"
                                    onclick="switchLanguage('en')" data-lang="en">EN</button>
                            <button type="button" class="language-option {% if LANGUAGE_CODE == 'ru' %}active{% endif %}"
                                    onclick="switchLanguage('ru')" data-lang="ru">RU</button>
                        </div>

                        <!-- –°–∫—Ä—ã—Ç–∞—è —Ñ–æ—Ä–º–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ -->
                        <form id="hidden-language-form" action="{% url 'custom_set_language' %}" method="post" style="display: none;">
                            {% csrf_token %}
                            <input type="hidden" name="language" id="selected-language">
                        </form>
                    </div>
                </li>
            </ul>
        </nav>

        {% block breadcrumbs %}
        {% endblock %}

        {% block content %}{% endblock %}
    </div>
    
    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è 3D –∞–Ω–∏–º–∞—Ü–∏–∏ –ø—á–µ–ª—ã -->
    <div id="bee-container"></div>
</main>

{% if not user.is_authenticated %}
<div id="login-modal" class="auth-modal">
    <div class="square">
        <i style="--clr:#00ff0a;"></i>
        <i style="--clr:#ff0057;"></i>
        <i style="--clr:#fffd44;"></i>
        <div class="login">
            <span class="close-btn">√ó</span>
            <h2>Login</h2>
            <form method="post" action="{% url 'accounts:login_ajax' %}" class="login-form">
                {% csrf_token %}
                <div class="inputBx">
                    <input type="text" name="username" placeholder="Username" required>
                </div>
                <div class="inputBx password-group">
                    <input type="password" name="password" id="password" placeholder="Password" required>
                    <button type="button" class="password-toggle" title="Reveal Password" aria-pressed="false">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <defs>
                                <mask id="eye-open">
                                    <path d="M1 12C1 12 5 4 12 4C19 4 23 12 23 12V20H12H1V12Z" fill="#D9D9D9"
                                          stroke="black" stroke-width="1.5" stroke-linejoin="round"/>
                                </mask>
                                <mask id="eye-closed">
                                    <path d="M1 12C1 12 5 20 12 20C19 20 23 12 23 12V20H12H1V12Z" fill="#D9D9D9"/>
                                </mask>
                            </defs>
                            <path class="lid lid--upper" d="M1 12C1 12 5 4 12 4C19 4 23 12 23 12" stroke="currentColor"
                                  stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <path class="lid lid--lower" d="M1 12C1 12 5 20 12 20C19 20 23 12 23 12"
                                  stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                                  stroke-linejoin="round"/>
                            <g mask="url(#eye-open)">
                                <g class="eye">
                                    <circle cy="12" cx="12" r="4" fill="currentColor"/>
                                    <circle cy="11" cx="13" r="1" fill="black"/>
                                </g>
                            </g>
                        </svg>
                        <span class="sr-only">Reveal</span>
                    </button>
                </div>
                <div class="error-message" style="color: red;"></div>
                <div class="inputBx">
                    <input type="submit" value="Login">
                </div>
                
                <!-- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å -->
                <div class="auth-divider">
                    <span>{% trans "–∏–ª–∏" %}</span>
                </div>
                
                <!-- Telegram Login Widget -->
                <div class="inputBx" style="display: flex; flex-direction: column; justify-content: center; align-items: center; gap: 12px;">

                    <!-- Telegram (–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å) -->
                    <a href="{% url 'social_auth:telegram_oauth_redirect' %}"
                       style="display: inline-flex; align-items: center; justify-content: center; gap: 10px; padding: 12px 24px; background: #229ED9; color: #fff; text-decoration: none; border-radius: 12px; font-size: 15px; font-weight: 600; transition: transform 0.1s ease, box-shadow 0.2s ease; box-shadow: 0 4px 10px rgba(34,158,217,0.35); width: 100%; max-width: 320px;"
                       onmouseover="this.style.boxShadow='0 6px 14px rgba(34,158,217,0.45)'; this.style.transform='translateY(-1px)'"
                       onmouseout="this.style.boxShadow='0 4px 10px rgba(34,158,217,0.35)'; this.style.transform='translateY(0)'">
                        <svg width="22" height="22" viewBox="0 0 240 240" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink:0;">
                            <circle cx="120" cy="120" r="120" fill="white"/>
                            <path d="M48 119.2c42.4-18.4 70.7-30.5 84.9-36.2 40.4-16.8 48.8-19.7 54.3-19.8 1.2 0 3.8.3 5.5 1.8 1.4 1.2 1.8 2.8 2 3.9.2 1 .4 3.3.2 5.1-1.9 20-10.2 68.5-14.4 90.9-1.8 9.7-5.8 12.9-9.5 13.3-8.1.7-14.2-5.2-22-10.2-12.2-7.7-19.1-12.5-30.8-20-13.9-8.9-4.9-13.8 3.1-21.8 2.2-2.2 40.1-36.7 40.9-39.8.1-.4.1-1.9-.8-2.6-.9-.7-2.3-.5-3.3-.3-1.4.3-23.5 15-66.5 43.8-6.3 4.4-12 6.6-17.1 6.5-5.6-.1-16.4-3.3-24.5-6.1-9.9-3.2-17.8-5-17-10.5.3-2.9 4.3-5.8 11.7-8.8Z" fill="#229ED9"/>
                        </svg>
                        <span>{% trans "Login with Telegram" %}</span>
                    </a>

                    <!-- GitHub (–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å) -->
                    <a href="{% url 'social_auth:github_oauth_redirect' %}"
                       style="display: inline-flex; align-items: center; justify-content: center; gap: 10px; padding: 12px 24px; background: #24292e; color: #fff; text-decoration: none; border-radius: 10px; font-size: 15px; font-weight: 600; transition: transform 0.1s ease, box-shadow 0.2s ease; box-shadow: 0 4px 10px rgba(0,0,0,0.25); width: 100%; max-width: 320px;"
                       onmouseover="this.style.boxShadow='0 6px 14px rgba(0,0,0,0.35)'; this.style.transform='translateY(-1px)'"
                       onmouseout="this.style.boxShadow='0 4px 10px rgba(0,0,0,0.25)'; this.style.transform='translateY(0)'">
                        <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor" style="flex-shrink:0;">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M12 .296c-6.627 0-12 5.373-12 12 0 5.303 3.438 9.8 8.207 11.387.6.111.793-.261.793-.58 0-.287-.011-1.244-.016-2.255-3.338.726-4.042-1.61-4.042-1.61-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.73.083-.73 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.108-.774.418-1.305.762-1.606-2.665-.304-5.467-1.332-5.467-5.93 0-1.31.469-2.38 1.236-3.22-.124-.303-.536-1.524.117-3.176 0 0 1.008-.322 3.301 1.23a11.52 11.52 0 0 1 3.003-.404c1.018.004 2.045.137 3.003.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.652.241 2.873.118 3.176.77.84 1.235 1.91 1.235 3.22 0 4.61-2.807 5.624-5.48 5.92.43.372.823 1.104.823 2.227 0 1.608-.014 2.904-.014 3.3 0 .321.192.697.799.579C20.565 22.092 24 17.592 24 12.296c0-6.627-5.373-12-12-12Z"/>
                        </svg>
                        <span>{% trans "Login with GitHub" %}</span>
                    </a>

                    <!-- Google -->
                    <a href="{% url 'social_auth:google_oauth_redirect' %}"
                       style="display: inline-flex; align-items: center; justify-content: center; gap: 10px; padding: 12px 24px; background: #fff; color: #3c4043; text-decoration: none; border: 1px solid #dadce0; border-radius: 10px; font-size: 15px; font-weight: 600; transition: transform 0.1s ease, box-shadow 0.2s ease; box-shadow: 0 2px 6px rgba(0,0,0,0.08); width: 100%; max-width: 320px;"
                       onmouseover="this.style.boxShadow='0 4px 10px rgba(0,0,0,0.12)'; this.style.transform='translateY(-1px)'"
                       onmouseout="this.style.boxShadow='0 2px 6px rgba(0,0,0,0.08)'; this.style.transform='translateY(0)'">
                        <svg width="22" height="22" viewBox="0 0 48 48" style="flex-shrink:0;">
                            <path fill="#EA4335" d="M24 9.5c3.35 0 5.62 1.45 6.91 2.66l5.05-4.92C32.82 4 28.79 2.5 24 2.5 14.99 2.5 7.36 7.98 4.11 15.3l5.88 4.56C11.77 13.18 17.39 9.5 24 9.5Z"/>
                            <path fill="#4285F4" d="M46.5 24.5c0-1.64-.15-3.19-.43-4.68H24v9.09h12.7c-.55 2.93-2.21 5.41-4.7 7.08l7.36 5.7C43.95 37.5 46.5 31.46 46.5 24.5Z"/>
                            <path fill="#FBBC05" d="M10 28.86c-.45-1.32-.71-2.72-.71-4.17 0-1.45.26-2.85.71-4.17l-5.88-4.56C2.76 18.65 2 21.48 2 24.69c0 3.21.76 6.04 2.12 8.73l5.88-4.56Z"/>
                            <path fill="#34A853" d="M24 46.5c6.48 0 11.92-2.13 15.89-5.85l-7.36-5.7c-2.06 1.39-4.7 2.22-8.53 2.22-6.61 0-12.23-3.68-13.98-8.86l-5.88 4.56C7.36 40.02 14.99 46.5 24 46.5Z"/>
                            <path fill="none" d="M2 2h44v44H2z"/>
                        </svg>
                        <span>{% trans "Login with Google" %}</span>
                    </a>

                </div>
                
                <div class="links">
                    <a href="#" id="to-forgot">{% trans "Forgot Password?" %}</a>
                    <a href="#" id="to-register">{% trans "Signup" %}</a>
                </div>
            </form>
        </div>
    </div>
</div>
<div id="register-modal" class="auth-modal">
    <div class="square">
        <i style="--clr:#00ff0a;"></i>
        <i style="--clr:#ff0057;"></i>
        <i style="--clr:#fffd44;"></i>
        <div class="login register">
            <span class="close-btn">√ó</span>
            <h2>Register</h2>
            {% if request.GET.error %}
                <div class="error-message">
                    <p>{{ request.GET.error|safe }}</p>
                </div>
            {% endif %}
            <form method="post" action="{% url 'accounts:register' %}">
                {% csrf_token %}
                <div class="inputBx">
                    <input type="text" name="username" placeholder="Username" required>
                </div>
                <div class="inputBx">
                    <input type="email" name="email" placeholder="Email" required>
                </div>
                <div class="inputBx">
                    <input type="password" name="password" placeholder="Password" required>
                </div>
                <div class="inputBx">
                    <input type="password" name="password_confirm" placeholder="Confirm Password" required>
                </div>
                <div class="inputBx">
                    <input type="submit" value="Register">
                </div>
                <div class="links">
                    <a href="#" id="to-login">Already have an account? Login</a>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="forgot-modal" class="auth-modal">
    <div class="square">
        <i style="--clr:#00ff0a;"></i>
        <i style="--clr:#ff0057;"></i>
        <i style="--clr:#fffd44;"></i>
        <div class="login forgot">
            <span class="close-btn">&times;</span>
            <h2>{% trans "Forgot Password?" %}</h2>
            <p>{% trans "Enter your email address below and we'll send you a link to reset your password." %}</p>
            <form method="post" action="{% url 'accounts:password_reset' %}">
                {% csrf_token %}
                <div class="inputBx">
                    <input type="email" name="email" required placeholder="{% trans 'Enter your email' %}">
                </div>
                <div class="inputBx">
                    <input type="submit" value="{% trans 'Send Reset Link' %}">
                </div>
                <div class="links">
                    <a href="#" id="back-to-login">{% trans "Back to Login" %}</a>
                </div>
            </form>
        </div>
    </div>
</div>
{% endif %}

<script defer src="{% static 'blog/js/main.js' %}"></script>
<script>
    window.loginUrl = "{% url 'accounts:login' %}";
</script>
<script defer src="{% static 'blog/js/auth_modal.js' %}"></script>
<!-- Password animation –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ GSAP (—Å–º. –±–ª–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏ GSAP –Ω–∏–∂–µ) -->
<!-- Telegram Auth -->
<!-- <script defer src="{% static 'social_auth/js/telegram-auth.js' %}"></script> -->

<script>
    document.addEventListener('DOMContentLoaded', function () {
        console.log('üöÄ DOMContentLoaded —Å—Ä–∞–±–æ—Ç–∞–ª');
        const urlParams = new URLSearchParams(window.location.search);
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        if (urlParams.has('registration_success')) {
            const notification = document.createElement('div');
            notification.className = 'message-notification success';
            notification.textContent = 'Registration successful! Welcome!';
            document.body.appendChild(notification);
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ GitHub
        if (urlParams.has('github_auth_success')) {
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Ö–æ–¥–∞ –µ—Å–ª–∏ –æ–Ω–æ –æ—Ç–∫—Ä—ã—Ç–æ
            const loginModal = document.getElementById('login-modal');
            if (loginModal && loginModal.classList.contains('active')) {
                loginModal.classList.remove('active');
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            const notification = document.createElement('div');
            notification.className = 'message-notification success';
            notification.textContent = '–£—Å–ø–µ—à–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ GitHub!';
            document.body.appendChild(notification);
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Telegram
        if (urlParams.has('telegram_auth_success')) {
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Ö–æ–¥–∞ –µ—Å–ª–∏ –æ–Ω–æ –æ—Ç–∫—Ä—ã—Ç–æ
            const loginModal = document.getElementById('login-modal');
            if (loginModal && loginModal.classList.contains('active')) {
                loginModal.classList.remove('active');
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
            const notification = document.createElement('div');
            notification.className = 'message-notification success';
            notification.textContent = '–£—Å–ø–µ—à–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram!';
            document.body.appendChild(notification);
            setTimeout(() => {
                notification.remove();
            }, 3000);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
            setTimeout(() => {
                window.location.href = window.location.pathname;
            }, 1500);
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –æ—à–∏–±–æ–∫
        console.log('üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã...');
        console.log('URL params:', urlParams.toString());
        console.log('open_register:', urlParams.has('open_register'));
        console.log('error:', urlParams.has('error'));
        
        // –ö–†–ò–¢–ò–ß–ù–û: –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ—Ç Telegram
        // Telegram –º–æ–∂–µ—Ç –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–≤—É–º—è —Å–ø–æ—Å–æ–±–∞–º–∏:
        // 1. –í query –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö: ?id=...&hash=...
        // 2. –í hash fragment: #tgAuthResult=base64_json (–Ω–æ–≤—ã–π –º–µ—Ç–æ–¥)
        
        let telegramData = null;
        
        // –°–ø–æ—Å–æ–± 1: –ü—Ä–æ–≤–µ—Ä—è–µ–º hash fragment #tgAuthResult=...
        const hash = window.location.hash;
        if (hash && hash.startsWith('#tgAuthResult=')) {
            console.log('üîê ============================================');
            console.log('üîê –û–ë–ù–ê–†–£–ñ–ï–ù–´ –î–ê–ù–ù–´–ï –û–¢ TELEGRAM –í HASH FRAGMENT!');
            console.log('üîê ============================================');
            
            try {
                const base64Data = hash.substring('#tgAuthResult='.length);
                console.log('  - Base64 –¥–∞–Ω–Ω—ã–µ:', base64Data.substring(0, 100) + '...');
                
                // –î–µ–∫–æ–¥–∏—Ä—É–µ–º base64
                const decodedData = atob(base64Data);
                console.log('  - –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:', decodedData.substring(0, 200) + '...');
                
                // –ü–∞—Ä—Å–∏–º JSON
                telegramData = JSON.parse(decodedData);
                console.log('  - –†–∞—Å–ø–∞—Ä—Å–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:', telegramData);
                
                // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ –Ω—É–∂–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (id –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º)
                if (telegramData.id) {
                    telegramData.id = parseInt(telegramData.id);
                }
                if (telegramData.auth_date) {
                    telegramData.auth_date = parseInt(telegramData.auth_date);
                }
                
                console.log('  - –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:', telegramData);
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ hash fragment:', error);
                telegramData = null;
            }
        }
        
        // –°–ø–æ—Å–æ–± 2: –ü—Ä–æ–≤–µ—Ä—è–µ–º query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (—Å—Ç–∞—Ä—ã–π –º–µ—Ç–æ–¥)
        if (!telegramData) {
            const telegramId = urlParams.get('id');
            const telegramHash = urlParams.get('hash');
            
            if (telegramId && telegramHash) {
                console.log('üîê ============================================');
                console.log('üîê –û–ë–ù–ê–†–£–ñ–ï–ù–´ –î–ê–ù–ù–´–ï –û–¢ TELEGRAM –í URL –ü–ê–†–ê–ú–ï–¢–†–ê–•!');
                console.log('üîê ============================================');
                console.log('  - ID:', telegramId);
                console.log('  - Hash:', telegramHash);
                console.log('  - Auth Date:', urlParams.get('auth_date'));
                console.log('  - First Name:', urlParams.get('first_name'));
                console.log('  - Username:', urlParams.get('username'));
                
                // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç Telegram
                telegramData = {
                    id: parseInt(telegramId),
                    hash: telegramHash,
                    auth_date: urlParams.get('auth_date') ? parseInt(urlParams.get('auth_date')) : null,
                    first_name: urlParams.get('first_name') || '',
                    last_name: urlParams.get('last_name') || '',
                    username: urlParams.get('username') || '',
                    photo_url: urlParams.get('photo_url') || ''
                };
                
                console.log('  - –°–æ–±—Ä–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:', telegramData);
            }
        }
        
        // –ï—Å–ª–∏ –Ω–∞—à–ª–∏ –¥–∞–Ω–Ω—ã–µ –æ—Ç Telegram, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
        if (telegramData && telegramData.id && telegramData.hash) {
            console.log('  - –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä...');
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
            const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]')?.value || 
                             document.cookie.match(/csrftoken=([^;]+)/)?.[1] || '';
            
            fetch('/api/social-auth/telegram/auth/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': csrfToken
                },
                body: JSON.stringify(telegramData),
                credentials: 'include'
            })
            .then(async response => {
                console.log('üì• –°—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞:', response.status, response.statusText);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞
                if (!response.ok) {
                    const errorText = await response.text().catch(() => '');
                    console.error('‚ùå –û—à–∏–±–∫–∞ HTTP:', response.status, errorText);
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                // –ü—ã—Ç–∞–µ–º—Å—è —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å JSON
                try {
                    const contentType = response.headers.get('content-type');
                    if (contentType && contentType.includes('application/json')) {
                        return await response.json();
                    } else {
                        const text = await response.text();
                        console.warn('‚ö†Ô∏è –û—Ç–≤–µ—Ç –Ω–µ JSON, –ø—ã—Ç–∞–µ–º—Å—è —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å:', text);
                        return JSON.parse(text);
                    }
                } catch (parseError) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON:', parseError);
                    throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –æ—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞');
                }
            })
            .then(data => {
                console.log('‚úÖ –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞:', data);
                if (data && data.success) {
                    console.log('üéâ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É...');
                    // –û—á–∏—â–∞–µ–º URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ hash, –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É
                    window.history.replaceState({}, document.title, window.location.pathname + window.location.search);
                    setTimeout(function() {
                        window.location.reload();
                    }, 500);
                } else {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:', data?.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞');
                    // –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º alert –¥–ª—è –º–∏–º–æ–ª–µ—Ç–Ω—ã—Ö –æ—à–∏–±–æ–∫, —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏—Ä—É–µ–º
                    if (data?.error && !data.error.includes('—É–∂–µ')) {
                        console.warn('‚ö†Ô∏è –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:', data.error);
                    }
                }
            })
            .catch(error => {
                console.error('‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä:', error);
                // –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º alert –¥–ª—è –º–∏–º–æ–ª–µ—Ç–Ω—ã—Ö –æ—à–∏–±–æ–∫, —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏—Ä—É–µ–º
                console.warn('‚ö†Ô∏è –û—à–∏–±–∫–∞:', error.message);
            });
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–ª—å–Ω–µ–π—à—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ open_register
            return;
        }
        
        if (urlParams.has('open_register')) {
            console.log('üîç –ù–∞–π–¥–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä open_register');
            
            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–µ–±–æ–ª—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
            setTimeout(() => {
                const registerModal = document.getElementById('register-modal');
                console.log('üìã –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:', registerModal);
                
                if (registerModal) {
                    console.log('‚úÖ –û—Ç–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏');
                    registerModal.classList.add('active');
                    console.log('üéØ –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ');
                } else {
                    console.log('‚ùå –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
                    console.log('üîç –í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å id –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ:');
                    document.querySelectorAll('[id]').forEach(el => {
                        console.log('  -', el.id, ':', el.tagName);
                    });
                }
            }, 100);
        } else {
            console.log('‚ùå –ü–∞—Ä–∞–º–µ—Ç—Ä open_register –Ω–µ –Ω–∞–π–¥–µ–Ω');
        }
    });
</script>
<script>
    // Globe Language Switcher JavaScript
    document.addEventListener('DOMContentLoaded', function() {
        const globeToggle = document.getElementById('globe-toggle');
        const languageDropdown = document.getElementById('language-dropdown');
        const languageSwitcherGlobe = document.querySelector('.language-switcher-globe');

        if (globeToggle && languageDropdown) {
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ dropdown –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –≥–ª–æ–±—É—Å
            globeToggle.addEventListener('click', function(e) {
                e.stopPropagation();

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–∑–∏—Ü–∏—é –∏ –¥–æ—Å—Ç—É–ø–Ω–æ–µ –º–µ—Å—Ç–æ
                adjustDropdownPosition();

                languageDropdown.classList.toggle('active');
            });

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤ –Ω–∞ –∫–Ω–æ–ø–∫–∏ —è–∑—ã–∫–∞ (fallback)
            const languageButtons = document.querySelectorAll('.language-option');
            languageButtons.forEach(button => {
                button.addEventListener('click', function(e) {
                    const lang = this.getAttribute('data-lang');
                    if (lang) {
                        // –ü—ã—Ç–∞–µ–º—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
                        switchLanguage(lang);
                    }
                });
            });

            // –ó–∞–∫—Ä—ã—Ç–∏–µ dropdown –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –æ–±–ª–∞—Å—Ç–∏
            document.addEventListener('click', function(e) {
                if (!languageSwitcherGlobe.contains(e.target)) {
                    languageDropdown.classList.remove('active');
                }
            });

            // –ó–∞–∫—Ä—ã—Ç–∏–µ dropdown –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ Escape
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && languageDropdown.classList.contains('active')) {
                    languageDropdown.classList.remove('active');
                }
            });

            // –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
            window.addEventListener('resize', function() {
                if (languageDropdown.classList.contains('active')) {
                    adjustDropdownPosition();
                }
            });
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ–∑–∏—Ü–∏–∏ dropdown
        function adjustDropdownPosition() {
            if (!globeToggle || !languageDropdown) return;

            const rect = globeToggle.getBoundingClientRect();
            const viewportHeight = window.innerHeight;
            const dropdownHeight = 80; // –ü—Ä–∏–º–µ—Ä–Ω–∞—è –≤—ã—Å–æ—Ç–∞ dropdown
            const spaceBelow = viewportHeight - rect.bottom;
            const spaceAbove = rect.top;

            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –∫–ª–∞—Å—Å—ã
            languageDropdown.classList.remove('show-above', 'show-below');

            // –ï—Å–ª–∏ –º–µ—Å—Ç–∞ —Å–Ω–∏–∑—É –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, –Ω–æ —Å–≤–µ—Ä—Ö—É –µ—Å—Ç—å –º–µ—Å—Ç–æ
            if (spaceBelow < dropdownHeight && spaceAbove > dropdownHeight) {
                languageDropdown.classList.add('show-above');
            } else {
                languageDropdown.classList.add('show-below');
            }
        }
    });

    // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —è–∑—ã–∫–∞
    function switchLanguage(lang) {
        const selectedLanguageInput = document.getElementById('selected-language');
        const hiddenForm = document.getElementById('hidden-language-form');
        const languageDropdown = document.getElementById('language-dropdown');

        if (selectedLanguageInput && hiddenForm) {
            selectedLanguageInput.value = lang;
            languageDropdown.classList.remove('active');

            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–µ–±–æ–ª—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É –¥–ª—è –ø–ª–∞–≤–Ω–æ—Å—Ç–∏ –∞–Ω–∏–º–∞—Ü–∏–∏
            setTimeout(() => {
                hiddenForm.submit();
            }, 150);
        } else {
            // Fallback: –ø—Ä—è–º–æ–π –ø–µ—Ä–µ—Ö–æ–¥ –ø–æ URL (—Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ)
            const currentPath = window.location.pathname;
            const pathParts = currentPath.split('/');
            
            // –£–±–∏—Ä–∞–µ–º —è–∑—ã–∫–æ–≤–æ–π –ø—Ä–µ—Ñ–∏–∫—Å –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å
            if (pathParts.length > 1 && (pathParts[1] === 'en' || pathParts[1] === 'ru')) {
                pathParts.splice(1, 1); // –£–±–∏—Ä–∞–µ–º —è–∑—ã–∫–æ–≤–æ–π –ø—Ä–µ—Ñ–∏–∫—Å
            }
            
            // –°–æ–±–∏—Ä–∞–µ–º –Ω–æ–≤—ã–π –ø—É—Ç—å
            const newPath = `/${lang}${pathParts.join('/')}`;
            window.location.href = newPath;
        }
    }
</script>
<script>
    // –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å–∞–π–¥–±–∞—Ä–∞
    document.addEventListener('DOMContentLoaded', function() {
        const sidebar = document.querySelector('.sidebar');
        const mainContent = document.querySelector('.main-content');

        if (sidebar) {
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–æ–±–∏–ª—å–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
            function isMobileOrTablet() {
                return window.innerWidth <= 1024; // –ü–ª–∞–Ω—à–µ—Ç—ã –∏ –º–æ–±–∏–ª—å–Ω—ã–µ
            }

            // –°–æ–∑–¥–∞–µ–º overlay –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è —Å–∞–π–¥–±–∞—Ä–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
            const overlay = document.createElement('div');
            overlay.className = 'sidebar-overlay';
            document.body.appendChild(overlay);

            // –ò—â–µ–º –∫–Ω–æ–ø–∫—É-—É–∫–∞–∑–∞—Ç–µ–ª—å –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è —Å–∞–π–¥–±–∞—Ä–∞ (–æ–±—ã—á–Ω–æ —ç—Ç–æ –∏–∫–æ–Ω–∫–∞ –º–µ–Ω—é)
            const sidebarToggle = document.querySelector('.sidebar-toggle, .menu-toggle, .hamburger');

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è —Å–∞–π–¥–±–∞—Ä–∞
            function openSidebar() {
                sidebar.classList.add('active');
                overlay.classList.add('active');
                document.body.classList.add('sidebar-open');
            }

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è —Å–∞–π–¥–±–∞—Ä–∞
            function closeSidebar() {
                sidebar.classList.remove('active');
                overlay.classList.remove('active');
                document.body.classList.remove('sidebar-open');
            }

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∞–π–¥–±–∞—Ä–∞
            function toggleSidebar() {
                if (sidebar.classList.contains('active')) {
                    closeSidebar();
                } else {
                    openSidebar();
                }
            }

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ –∫–Ω–æ–ø–∫–µ-—É–∫–∞–∑–∞—Ç–µ–ª—é (–µ—Å–ª–∏ –µ—Å—Ç—å)
            if (sidebarToggle) {
                sidebarToggle.addEventListener('click', function(e) {
                    e.stopPropagation();
                    if (isMobileOrTablet()) {
                        toggleSidebar();
                    }
                });
            }

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ —Å–∞–π–¥–±–∞—Ä—É –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
            sidebar.addEventListener('click', function(e) {
                if (isMobileOrTablet()) {
                    // –ï—Å–ª–∏ –∫–ª–∏–∫–Ω—É–ª–∏ –ø–æ —Å—Å—ã–ª–∫–µ - –ù–ï –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–ª–∏–∫
                    if (e.target.tagName === 'A' || e.target.closest('a')) {
                        return; // –í—ã—Ö–æ–¥–∏–º –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏, –Ω–µ –∏–∑–º–µ–Ω—è—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∞–π–¥–±–∞—Ä–∞
                    }

                    e.stopPropagation();

                    // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∞–π–¥–±–∞—Ä–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –ª—é–±—É—é –æ–±–ª–∞—Å—Ç—å (–∫—Ä–æ–º–µ —Å—Å—ã–ª–æ–∫)
                    toggleSidebar();
                }
            });

            // –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–∞–π–¥–±–∞—Ä–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ overlay
            overlay.addEventListener('click', function() {
                closeSidebar();
            });

            // –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–∞–π–¥–±–∞—Ä–∞ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ Escape
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && sidebar.classList.contains('active')) {
                    closeSidebar();
                }
            });

            // –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–∞–π–¥–±–∞—Ä–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞ –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø
            window.addEventListener('resize', function() {
                if (!isMobileOrTablet() && sidebar.classList.contains('active')) {
                    closeSidebar();
                }
            });

            // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç: –µ—Å–ª–∏ –Ω–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –∫–Ω–æ–ø–∫–∏-—É–∫–∞–∑–∞—Ç–µ–ª—è,
            // –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–ª–∏–∫–∞ –ø–æ –æ–±–ª–∞—Å—Ç–∏ —Å–∞–π–¥–±–∞—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Å—Å—ã–ª–∫–æ–π
            // –ù–∞–ø—Ä–∏–º–µ—Ä, –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É –∏–ª–∏ –ø—É—Å—Ç–æ–π –æ–±–ª–∞—Å—Ç–∏
            const sidebarHeader = sidebar.querySelector('.sidebar-header, .profile-info');
            if (sidebarHeader) {
                sidebarHeader.addEventListener('click', function(e) {
                    e.stopPropagation();
                    if (isMobileOrTablet()) {
                        toggleSidebar();
                    }
                });
            }
        }
    });

    // –ò—â–µ–º –∫–Ω–æ–ø–∫—É-—É–∫–∞–∑–∞—Ç–µ–ª—å –ø–æ –∞—Ç—Ä–∏–±—É—Ç—É data-sidebar-btn
    const sidebarButton = document.querySelector('[data-sidebar-btn]');

    if (sidebarButton) {
        sidebarButton.addEventListener('click', function(e) {
            e.stopPropagation();
            if (isMobileOrTablet()) {
                if (sidebar.classList.contains('active')) {
                    sidebar.classList.remove('active');
                    overlay.classList.remove('active');
                    document.body.classList.remove('sidebar-open');
                } else {
                    sidebar.classList.add('active');
                    overlay.classList.add('active');
                    document.body.classList.add('sidebar-open');
                }
            }
        });
    }
</script>
<style>
    .message-notification {
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 10px 20px;
        border-radius: 5px;
        z-index: 1000;
    }

    .message-notification.success {
        background-color: rgba(46, 204, 113, 0.2);
        color: #2ecc71;
        border: 1px solid #2ecc71;
    }
    .home-link {
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .home-link i {
        font-size: 1.1em;
        transition: transform 0.2s ease;
    }

    .home-link:hover i {
        transform: scale(1.1);
    }

    /* –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –∏–∫–æ–Ω–∫—É –Ω–∞ –≤—Å–µ—Ö —ç–∫—Ä–∞–Ω–∞—Ö */
    .nav-text {
        display: none;
    }

    .home-link {
        justify-content: center;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ 3D –ø—á–µ–ª—ã */
    #bee-container {
        position: fixed;
        width: 500px;
        height: 500px;
        pointer-events: none;
        z-index: 999;
        top: 60%;
        left: 70%;
        transform: translate(-50%, -50%);
        opacity: 0;
        transition: opacity 0.5s ease-in-out;
        background: transparent !important;
        border: none !important;
        box-shadow: none !important;
    }

    #bee-container canvas {
        background: transparent !important;
        border: none !important;
        box-shadow: none !important;
    }

    @media (max-width: 580px) {
        #bee-container {
            width: 400px;
            height: 400px;
            left: 30%;
            opacity: 0;
        }
    }

</style>
<!-- –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è 3D –∞–Ω–∏–º–∞—Ü–∏–∏ –ø—á–µ–ª—ã (lazy load –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏) -->
<script>
    // Lazy load —Ç—è–∂–µ–ª—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –∞–Ω–∏–º–∞—Ü–∏–∏ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    // –£–≤–µ–ª–∏—á–µ–Ω–∞ –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è ScrollTrigger, —á—Ç–æ–±—ã –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫
    window.addEventListener('load', function() {
        // –ó–∞–≥—Ä—É–∂–∞–µ–º GSAP —Å –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π –¥–ª—è password-animation.js
        setTimeout(function() {
            var gsapScript = document.createElement('script');
            gsapScript.src = '{% static "blog/js/gsap.min.js" %}';
            gsapScript.defer = true;
            document.body.appendChild(gsapScript);
            
            gsapScript.onload = function() {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º password-animation.js –ø–æ—Å–ª–µ GSAP (–Ω—É–∂–µ–Ω –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ª–æ–≥–∏–Ω–∞)
                var passwordAnimationScript = document.createElement('script');
                passwordAnimationScript.src = '{% static "blog/js/password-animation.js" %}';
                passwordAnimationScript.defer = true;
                document.body.appendChild(passwordAnimationScript);
            };
        }, 2000); // –ó–∞–¥–µ—Ä–∂–∫–∞ 2 —Å–µ–∫—É–Ω–¥—ã –¥–ª—è GSAP
        
        // ScrollTrigger –∑–∞–≥—Ä—É–∂–∞–µ–º —Å –±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π, —á—Ç–æ–±—ã –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫
        setTimeout(function() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ GSAP —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω
            if (typeof gsap === 'undefined') {
                var gsapScript = document.createElement('script');
                gsapScript.src = '{% static "blog/js/gsap.min.js" %}';
                gsapScript.defer = true;
                document.body.appendChild(gsapScript);
                
                gsapScript.onload = function() {
                    loadScrollTrigger();
                };
            } else {
                loadScrollTrigger();
            }
            
            function loadScrollTrigger() {
                var scrollTriggerScript = document.createElement('script');
                scrollTriggerScript.src = '{% static "blog/js/ScrollTrigger.min.js" %}';
                scrollTriggerScript.defer = true;
                document.body.appendChild(scrollTriggerScript);
                
                scrollTriggerScript.onload = function() {
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º bee-scroll.js —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ ScrollTrigger
                    setTimeout(function() {
                        var beeScript = document.createElement('script');
                        beeScript.type = 'module';
                        beeScript.src = '{% static "blog/js/bee-scroll.js" %}';
                        beeScript.defer = true;
                        document.body.appendChild(beeScript);
                    }, 1000); // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è bee-scroll.js
                };
            }
        }, 6000); // –ó–∞–¥–µ—Ä–∂–∫–∞ 6 —Å–µ–∫—É–Ω–¥ –¥–ª—è ScrollTrigger (–∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)
    });
</script>

<!-- Telegram Auth Handler - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ -->
<script>
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ postMessage –æ—Ç iframe –≤–∏–¥–∂–µ—Ç–∞ (–Ω–∞ —Å–ª—É—á–∞–π –µ—Å–ª–∏ –≤–∏–¥–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç postMessage –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ –≤—ã–∑–æ–≤–∞)
    window.addEventListener('message', function(event) {
        // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (telegram_auth_success.html)
        // –≠—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç —Å —Ç–æ–≥–æ –∂–µ origin (quiz-code.com), –ø–æ—ç—Ç–æ–º—É –ø—Ä–æ–≤–µ—Ä—è–µ–º –µ–≥–æ –ø–µ—Ä–≤—ã–º
        if (event.data && event.data.type === 'TELEGRAM_AUTH_SUCCESS') {
            console.log('‚úÖ ============================================');
            console.log('‚úÖ –ü–û–õ–£–ß–ï–ù–û –°–û–û–ë–©–ï–ù–ò–ï –û–ë –£–°–ü–ï–®–ù–û–ô –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò!');
            console.log('‚úÖ ============================================');
            console.log('  - origin:', event.origin);
            console.log('  - –î–∞–Ω–Ω—ã–µ:', event.data);
            console.log('  - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:', event.data.user);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            console.log('  - –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É...');
            const loginModal = document.getElementById('login-modal');
            if (loginModal && loginModal.classList.contains('active')) {
                loginModal.classList.remove('active');
            }
            window.location.reload();
            return;
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç Telegram OAuth (oauth.telegram.org –∏–ª–∏ telegram.org)
        if (event.origin !== 'https://oauth.telegram.org' && event.origin !== 'https://telegram.org') {
            return;
        }
        
        console.log('üì® –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç Telegram OAuth iframe:');
        console.log('  - origin:', event.origin);
        console.log('  - data:', event.data);
        console.log('  - data type:', typeof event.data);
        console.log('  - full event:', event);
        
        let data = event.data;
        
        // –ü—ã—Ç–∞–µ–º—Å—è —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å JSON –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏—Ö–æ–¥—è—Ç –∫–∞–∫ —Å—Ç—Ä–æ–∫–∞
        if (typeof data === 'string') {
            try {
                const parsed = JSON.parse(data);
                console.log('  - parsed data:', parsed);
                
                // –ï—Å–ª–∏ —ç—Ç–æ —Å–æ–±—ã—Ç–∏–µ ready/resize, –ø—Ä–æ—Å—Ç–æ –ª–æ–≥–∏—Ä—É–µ–º
                if (parsed.event && (parsed.event === 'ready' || parsed.event === 'resize')) {
                    console.log('  ‚ÑπÔ∏è –°–æ–±—ã—Ç–∏–µ –≤–∏–¥–∂–µ—Ç–∞:', parsed.event);
            return;
        }
        
                // –ï—Å–ª–∏ —ç—Ç–æ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–µ—Å—Ç—å id)
                if (parsed.id) {
                    console.log('‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram —á–µ—Ä–µ–∑ postMessage (JSON —Å—Ç—Ä–æ–∫–∞)!');
                    console.log('  - user data:', parsed);
                    data = parsed;
                }
            } catch (e) {
                console.log('  ‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å JSON:', e);
                // –í–æ–∑–º–æ–∂–Ω–æ, —ç—Ç–æ –Ω–µ JSON, –Ω–æ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                if (data && typeof data === 'string' && data.includes('id')) {
                    console.log('  - –ü–æ–ø—ã—Ç–∫–∞ –∏–∑–≤–ª–µ—á—å –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å—Ç—Ä–æ–∫–∏...');
                }
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö (Telegram –≤–∏–¥–∂–µ—Ç –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
        // –î–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –∫–∞–∫ –æ–±—ä–µ–∫—Ç —Å –ø–æ–ª—è–º–∏: id, first_name, last_name, username, photo_url, auth_date, hash
        // –ò–õ–ò –∫–∞–∫ –æ–±—ä–µ–∫—Ç —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º –ø–æ–ª–µ–º user: {user: {id, first_name, ...}}
        if (data && typeof data === 'object') {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –≤–ª–æ–∂–µ–Ω–Ω–æ–µ –ø–æ–ª–µ user
            let userData = null;
            if (data.user && typeof data.user === 'object' && data.user.id) {
                console.log('‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ {user: {...}}');
                userData = data.user;
            } else if (data.id && (data.first_name !== undefined || data.username !== undefined || data.auth_date !== undefined)) {
                // –î–∞–Ω–Ω—ã–µ –ø—Ä–∏—Ö–æ–¥—è—Ç –Ω–∞–ø—Ä—è–º—É—é –∫–∞–∫ –æ–±—ä–µ–∫—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                console.log('‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram –Ω–∞–ø—Ä—è–º—É—é!');
                userData = data;
            }
            
            if (userData) {
            console.log('‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram —á–µ—Ä–µ–∑ postMessage!');
                console.log('  - user data:', userData);
                console.log('  - user id:', userData.id);
                console.log('  - username:', userData.username);
                console.log('  - first_name:', userData.first_name);
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –≥–ª–æ–±–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é handleTelegramAuth –µ—Å–ª–∏ –æ–Ω–∞ –¥–æ—Å—Ç—É–ø–Ω–∞
            if (typeof window.handleTelegramAuth === 'function') {
                console.log('  - –í—ã–∑—ã–≤–∞–µ–º handleTelegramAuth...');
                    window.handleTelegramAuth(userData);
            } else {
                console.error('‚ùå –§—É–Ω–∫—Ü–∏—è handleTelegramAuth –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!');
            }
                return;
            }
        }
        
        // –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ª–æ–≥–∏—Ä—É–µ–º –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
        console.log('  ‚ö†Ô∏è –î–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º');
        console.log('  - –ü—Ä–æ–≤–µ—Ä–∫–∞: data.id =', data && data.id);
        console.log('  - –ü—Ä–æ–≤–µ—Ä–∫–∞: data.first_name =', data && data.first_name);
        console.log('  - –ü—Ä–æ–≤–µ—Ä–∫–∞: data.username =', data && data.username);
    });
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É –≤–∏–¥–∂–µ—Ç–∞ –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
    document.addEventListener('DOMContentLoaded', function() {
        console.log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ Telegram –≤–∏–¥–∂–µ—Ç–∞...');
        console.log('üì¶ –†–µ–∂–∏–º –±—Ä–∞—É–∑–µ—Ä–∞:', navigator.cookieEnabled ? '–û–±—ã—á–Ω—ã–π' : '–ò–Ω–∫–æ–≥–Ω–∏—Ç–æ/–ü—Ä–∏–≤–∞—Ç–Ω—ã–π');
        console.log('üì¶ Cookies –≤–∫–ª—é—á–µ–Ω—ã:', navigator.cookieEnabled);
        console.log('üì¶ LocalStorage –¥–æ—Å—Ç—É–ø–µ–Ω:', typeof(Storage) !== 'undefined' ? '–î–∞' : '–ù–µ—Ç');
        console.log('‚ö†Ô∏è –í–ê–ñ–ù–û: –í —Ä–µ–∂–∏–º–µ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã –º–æ–≥—É—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π –∏–∑ iframe!');
        console.log('‚ö†Ô∏è –ï—Å–ª–∏ –≤–∏–¥–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –≤ –æ–±—ã—á–Ω–æ–º —Ä–µ–∂–∏–º–µ –±—Ä–∞—É–∑–µ—Ä–∞.');
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É —Å–∫—Ä–∏–ø—Ç–∞ –≤–∏–¥–∂–µ—Ç–∞
        setTimeout(function() {
            const widgetScript = document.querySelector('script[data-telegram-login]') || document.querySelector('script[src*="telegram-widget.js"]');
            const widgetIframe = document.querySelector('iframe[src*="oauth.telegram.org"]');
            
            if (!widgetScript && !widgetIframe) {
                console.log('‚ÑπÔ∏è Telegram iframe –≤–∏–¥–∂–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å redirect). –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–ø—É—â–µ–Ω—ã.');
                return;
            }
            
            console.log('üìã Telegram –≤–∏–¥–∂–µ—Ç —Å—Ç–∞—Ç—É—Å:');
            console.log('  - –°–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∂–µ–Ω:', !!widgetScript);
            console.log('  - Iframe —Å–æ–∑–¥–∞–Ω:', !!widgetIframe);
            console.log('  - window.TelegramLoginWidget:', typeof window.TelegramLoginWidget);
            console.log('  - window.Telegram:', typeof window.Telegram);
            console.log('  - window.Telegram.LoginWidget:', window.Telegram && typeof window.Telegram.LoginWidget);
            console.log('  - handleTelegramAuth –¥–æ—Å—Ç—É–ø–Ω–∞:', typeof window.handleTelegramAuth);
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –Ω–æ–≤–æ–≥–æ API –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
            if (window.Telegram && window.Telegram.LoginWidget) {
                console.log('‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è window.Telegram.LoginWidget');
                window.Telegram.LoginWidget.dataOnauth = handleTelegramAuth;
                // –¢–∞–∫–∂–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —á–µ—Ä–µ–∑ window –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
                if (typeof window.handleTelegramAuth === 'function') {
                    window.Telegram.LoginWidget.dataOnauth = window.handleTelegramAuth;
                }
            }
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: —É–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–º scope
            if (typeof handleTelegramAuth === 'function') {
                window.handleTelegramAuth = handleTelegramAuth;
                window.onTelegramAuth = handleTelegramAuth;
                console.log('‚úÖ –§—É–Ω–∫—Ü–∏—è handleTelegramAuth –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∞ –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–º scope');
            } else {
                console.error('‚ùå –§—É–Ω–∫—Ü–∏—è handleTelegramAuth –ù–ï –Ω–∞–π–¥–µ–Ω–∞! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—è–¥–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤.');
            }
            
            if (!widgetIframe) {
                console.error('‚ùå Telegram –≤–∏–¥–∂–µ—Ç –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:');
                console.error('  1. –î–æ–º–µ–Ω –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ BotFather –¥–ª—è –±–æ—Ç–∞ {{ TELEGRAM_BOT_USERNAME }}');
                console.error('  2. –î–æ–º–µ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç–µ–∫—É—â–µ–º—É: ' + window.location.hostname);
                console.error('  3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ @BotFather: /setdomain –¥–ª—è –¥–æ–º–µ–Ω–∞ ' + window.location.hostname);
            } else {
                console.log('‚úÖ Telegram –≤–∏–¥–∂–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ!');
                console.log('üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:');
                console.log('');
                console.log('üîπ –®–ê–ì 1: –ö–ª–∏–∫–Ω–∏—Ç–µ –ø–æ –≤–∏–¥–∂–µ—Ç—É Telegram (–∫–Ω–æ–ø–∫–∞ "Login with Telegram")');
                console.log('üîπ –®–ê–ì 2: –ü–æ—Å–ª–µ –∫–ª–∏–∫–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏ –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:');
                console.log('    - üñ±Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω –∫–ª–∏–∫ –≤ –æ–±–ª–∞—Å—Ç–∏ Telegram –≤–∏–¥–∂–µ—Ç–∞');
                console.log('    - ‚úÖ handleTelegramAuth –≤—ã–∑–≤–∞–Ω–∞ –ø–æ—Å–ª–µ –∫–ª–∏–∫–∞!');
                console.log('    - üîê Telegram auth callback –≤—ã–∑–≤–∞–Ω –ü–†–Ø–ú–´–ú –í–´–ó–û–í–û–ú!');
                console.log('');
                console.log('‚ö†Ô∏è  –ï—Å–ª–∏ –ø–æ—Å–ª–µ –∫–ª–∏–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è:');
                console.log('    1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ @BotFather:');
                console.log('       - –û—Ç–∫—Ä–æ–π—Ç–µ @BotFather –≤ Telegram');
                console.log('       - –í—ã–±–µ—Ä–∏—Ç–µ –±–æ—Ç–∞: {{ TELEGRAM_BOT_USERNAME }}');
                console.log('       - –í—ã–ø–æ–ª–Ω–∏—Ç–µ: /setdomain');
                console.log('       - –£–∫–∞–∂–∏—Ç–µ –¥–æ–º–µ–Ω: ' + window.location.hostname);
                console.log('    2. –ï—Å–ª–∏ –¥–æ–º–µ–Ω –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –Ω–æ callback –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:');
                console.log('       - –í–∏–¥–∂–µ—Ç –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å redirect –≤–º–µ—Å—Ç–æ callback');
                console.log('       - –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å —á–µ—Ä–µ–∑ —Ä–µ–¥–∏—Ä–µ–∫—Ç');
                console.log('');
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∫–æ–π –º–µ—Ç–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
                const widgetScript = document.querySelector('script[data-telegram-login]');
                const usesCallback = widgetScript && widgetScript.hasAttribute('data-onauth');
                const usesRedirect = widgetScript && widgetScript.hasAttribute('data-auth-url');
                
                console.log('üìä –¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:');
                console.log('   - –î–æ–º–µ–Ω: ' + window.location.hostname);
                console.log('   - –ë–æ—Ç: {{ TELEGRAM_BOT_USERNAME }}');
                if (usesCallback) {
                    console.log('   - –ú–µ—Ç–æ–¥: ‚úÖ CALLBACK (data-onauth) - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è callback');
                    console.log('   - –ü—Ä–∏ –∫–ª–∏–∫–µ –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è handleTelegramAuth(user)');
                    console.log('   - –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ iframe, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç redirect');
                } else if (usesRedirect) {
                    console.log('   - –ú–µ—Ç–æ–¥: ‚ö†Ô∏è  REDIRECT (data-auth-url) - –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ iframe');
                    console.log('   - –ü—Ä–∏ –∫–ª–∏–∫–µ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /api/social-auth/telegram/auth/');
                    console.log('   - –ï—Å–ª–∏ –≤–∏–¥–∂–µ—Ç –≤ iframe, –±—Ä–∞—É–∑–µ—Ä –º–æ–∂–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç');
                } else {
                    console.log('   - –ú–µ—Ç–æ–¥: ‚ö†Ô∏è  –ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω');
                }
                console.log('‚úÖ Iframe –≤–∏–¥–∂–µ—Ç–∞ –Ω–∞–π–¥–µ–Ω, –¥–æ–±–∞–≤–ª—è–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥...');
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ iframe –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
                if (widgetIframe) {
                    // –°–æ–∑–¥–∞–µ–º overlay –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∫–ª–∏–∫–æ–≤
                    const overlay = document.createElement('div');
                    overlay.style.position = 'absolute';
                    overlay.style.top = widgetIframe.offsetTop + 'px';
                    overlay.style.left = widgetIframe.offsetLeft + 'px';
                    overlay.style.width = widgetIframe.offsetWidth + 'px';
                    overlay.style.height = widgetIframe.offsetHeight + 'px';
                    overlay.style.zIndex = '9999';
                    overlay.style.pointerEvents = 'none';
                    overlay.style.backgroundColor = 'transparent';
                    
                    // –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –∫–ª–∏–∫–∏ –≤ –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∂–µ—Ç–∞
                    widgetIframe.parentElement.style.position = 'relative';
                    widgetIframe.parentElement.appendChild(overlay);
                    
                    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
                    widgetIframe.parentElement.addEventListener('click', function(e) {
                        console.log('üñ±Ô∏è ============================================');
                        console.log('üñ±Ô∏è –ö–õ–ò–ö –ù–ê TELEGRAM –í–ò–î–ñ–ï–¢!');
                        console.log('üñ±Ô∏è ============================================');
                        console.log('  - –í—Ä–µ–º—è:', new Date().toISOString());
                        console.log('  - target:', e.target);
                        console.log('  - currentTarget:', e.currentTarget);
                        console.log('  - iframe:', widgetIframe);
                        console.log('  - iframe src:', widgetIframe.src);
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏
                        if (typeof window.handleTelegramAuth === 'function') {
                            console.log('  - ‚úÖ handleTelegramAuth –¥–æ—Å—Ç—É–ø–Ω–∞');
                        } else {
                            console.error('  - ‚ùå handleTelegramAuth –ù–ï –¥–æ—Å—Ç—É–ø–Ω–∞!');
                        }
                        
                        // –ú–æ–Ω–∏—Ç–æ—Ä–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ iframe –ø–æ—Å–ª–µ –∫–ª–∏–∫–∞
                        let initialIframeSrc = widgetIframe.src;
                        console.log('  - –ù–∞—á–∞–ª—å–Ω—ã–π URL iframe:', initialIframeSrc);
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è URL iframe –∫–∞–∂–¥—ã–µ 100ms –≤ —Ç–µ—á–µ–Ω–∏–µ 5 —Å–µ–∫—É–Ω–¥
                        let checkCount = 0;
                        const iframeCheckInterval = setInterval(function() {
                            checkCount++;
                            const currentSrc = widgetIframe.src;
                            if (currentSrc !== initialIframeSrc) {
                                console.log('  - üîÑ URL iframe –∏–∑–º–µ–Ω–∏–ª—Å—è!');
                                console.log('    –°—Ç–∞—Ä—ã–π:', initialIframeSrc);
                                console.log('    –ù–æ–≤—ã–π:', currentSrc);
                                
                                // –ï—Å–ª–∏ —ç—Ç–æ redirect –Ω–∞ –Ω–∞—à endpoint —Å –¥–∞–Ω–Ω—ã–º–∏
                                if (currentSrc.includes('/api/social-auth/telegram/auth/')) {
                                    console.log('  - ‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω redirect –Ω–∞ Telegram auth endpoint!');
                                    
                                    // –ü—ã—Ç–∞–µ–º—Å—è –∏–∑–≤–ª–µ—á—å –¥–∞–Ω–Ω—ã–µ –∏–∑ URL
                                    try {
                                        const url = new URL(currentSrc);
                                        const params = new URLSearchParams(url.search);
                                        const userData = {};
                                        
                                        // –ò–∑–≤–ª–µ–∫–∞–µ–º –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
                                        for (const [key, value] of params.entries()) {
                                            userData[key] = value;
                                        }
                                        
                                        if (userData.id) {
                                            console.log('  - ‚úÖ –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞–π–¥–µ–Ω—ã –≤ URL iframe!');
                                            console.log('  - user data:', userData);
                                            
                                            // –í—ã–∑—ã–≤–∞–µ–º handleTelegramAuth —Å –¥–∞–Ω–Ω—ã–º–∏
                                            if (typeof window.handleTelegramAuth === 'function') {
                                                console.log('  - –í—ã–∑—ã–≤–∞–µ–º handleTelegramAuth —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ URL...');
                                                window.handleTelegramAuth(userData);
                                            } else {
                                                console.error('  - ‚ùå handleTelegramAuth –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!');
                                            }
                                        } else {
                                            console.log('  - ‚ö†Ô∏è URL —Å–æ–¥–µ—Ä–∂–∏—Ç endpoint, –Ω–æ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
                                            console.log('  - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã URL:', Object.fromEntries(params));
                                        }
                                    } catch (e) {
                                        console.error('  - ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ URL iframe:', e);
                                    }
                                }
                                
                                initialIframeSrc = currentSrc;
                            }
                            
                            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥ –∏–ª–∏ –ø–æ—Å–ª–µ 50 –ø—Ä–æ–≤–µ—Ä–æ–∫
                            if (checkCount >= 50) {
                                clearInterval(iframeCheckInterval);
                                console.log('  - ‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π URL iframe');
                            }
                        }, 100);
                    }, true); // –ò—Å–ø–æ–ª—å–∑—É–µ–º capture phase
                }
                
                // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π URL (–¥–ª—è redirect –º–µ—Ç–æ–¥–∞)
                let currentUrl = window.location.href;
                const urlCheckInterval = setInterval(function() {
                    if (window.location.href !== currentUrl) {
                        const oldUrl = currentUrl;
                        currentUrl = window.location.href;
                        console.log('üîÑ –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ URL:');
                        console.log('  - –°—Ç–∞—Ä—ã–π URL:', oldUrl);
                        console.log('  - –ù–æ–≤—ã–π URL:', currentUrl);
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–º –æ—Ç Telegram
                        if (currentUrl.includes('/api/social-auth/telegram/auth/')) {
                            console.log('‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ Telegram auth endpoint!');
                            console.log('  - –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ URL...');
                            const urlParams = new URLSearchParams(window.location.search);
                            console.log('  - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã URL:', Object.fromEntries(urlParams));
                            
                            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ—Ç Telegram
                            if (urlParams.has('id')) {
                                console.log('‚úÖ –î–∞–Ω–Ω—ã–µ –æ—Ç Telegram –Ω–∞–π–¥–µ–Ω—ã –≤ URL!');
                            } else {
                                console.error('‚ùå –î–∞–Ω–Ω—ã–µ –æ—Ç Telegram –ù–ï –Ω–∞–π–¥–µ–Ω—ã –≤ URL!');
                                console.error('  - –í–æ–∑–º–æ–∂–Ω–æ, –¥–æ–º–µ–Ω –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ BotFather');
                                console.error('  - –ò–ª–∏ –≤–∏–¥–∂–µ—Ç –Ω–µ –º–æ–∂–µ—Ç –ø–µ—Ä–µ–¥–∞—Ç—å –¥–∞–Ω–Ω—ã–µ');
                            }
                        }
                    }
                }, 100);
                
                // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —á–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥
                setTimeout(function() {
                    clearInterval(urlCheckInterval);
                }, 30000);
                
                // –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–∑–º–µ–Ω–µ–Ω–∏–π URL –≤ iframe –≤–∏–¥–∂–µ—Ç–∞ (–µ—Å–ª–∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ iframe)
                if (widgetIframe) {
                    let iframeUrl = widgetIframe.src || '';
                    let lastCheckedUrl = iframeUrl;
                    const iframeUrlCheckInterval = setInterval(function() {
                        try {
                            // –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–ª—É—á–∏—Ç—å URL –∏–∑ iframe (–º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –∏–∑-–∑–∞ CORS)
                            const newIframeUrl = widgetIframe.src || '';
                            
                            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ URL
                            if (newIframeUrl !== lastCheckedUrl) {
                                console.log('üîÑ ============================================');
                                console.log('üîÑ –û–ë–ù–ê–†–£–ñ–ï–ù–û –ò–ó–ú–ï–ù–ï–ù–ò–ï URL IFRAME –í–ò–î–ñ–ï–¢–ê!');
                                console.log('üîÑ ============================================');
                                console.log('  - –°—Ç–∞—Ä—ã–π URL iframe:', lastCheckedUrl);
                                console.log('  - –ù–æ–≤—ã–π URL iframe:', newIframeUrl);
                                
                                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏ –Ω–æ–≤—ã–π URL –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                                if (newIframeUrl.includes('/api/social-auth/telegram/auth/')) {
                                    console.log('  - ‚úÖ URL —Å–æ–¥–µ—Ä–∂–∏—Ç auth endpoint!');
                                    
                                    // –ü—ã—Ç–∞–µ–º—Å—è –∏–∑–≤–ª–µ—á—å –¥–∞–Ω–Ω—ã–µ –∏–∑ URL
                                    try {
                                        const url = new URL(newIframeUrl);
                                        const params = new URLSearchParams(url.search);
                                        const userData = {};
                                        
                                        // –ò–∑–≤–ª–µ–∫–∞–µ–º –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
                                        for (const [key, value] of params.entries()) {
                                            userData[key] = value;
                                        }
                                        
                                        if (userData.id) {
                                            console.log('  - ‚úÖ –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞–π–¥–µ–Ω—ã –≤ URL iframe!');
                                            console.log('  - user data:', userData);
                                            
                                            // –í—ã–∑—ã–≤–∞–µ–º handleTelegramAuth —Å –¥–∞–Ω–Ω—ã–º–∏
                                            if (typeof window.handleTelegramAuth === 'function') {
                                                console.log('  - –í—ã–∑—ã–≤–∞–µ–º handleTelegramAuth —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ URL iframe...');
                                                window.handleTelegramAuth(userData);
                                            } else {
                                                console.error('  - ‚ùå handleTelegramAuth –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!');
                                            }
                                        } else {
                                            console.log('  - ‚ö†Ô∏è URL —Å–æ–¥–µ—Ä–∂–∏—Ç endpoint, –Ω–æ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
                                            console.log('  - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã URL:', Object.fromEntries(params));
                            }
                        } catch (e) {
                                        console.error('  - ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ URL iframe:', e);
                                    }
                                } else if (newIframeUrl.includes('return_to') && newIframeUrl.includes('quiz-code.com')) {
                                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏ URL return_to —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ query –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö
                                    console.log('  - URL —Å–æ–¥–µ—Ä–∂–∏—Ç return_to, –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö...');
                                    try {
                                        const url = new URL(newIframeUrl);
                                        const params = new URLSearchParams(url.search);
                                        
                                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                                        const userData = {};
                                        let hasUserData = false;
                                        
                                        for (const [key, value] of params.entries()) {
                                            if (key === 'id' || key === 'first_name' || key === 'username' || key === 'auth_date' || key === 'hash') {
                                                userData[key] = value;
                                                if (key === 'id') hasUserData = true;
                                            }
                                        }
                                        
                                        if (hasUserData && userData.id) {
                                            console.log('  - ‚úÖ –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞–π–¥–µ–Ω—ã –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö URL iframe!');
                                            console.log('  - user data:', userData);
                                            
                                            if (typeof window.handleTelegramAuth === 'function') {
                                                console.log('  - –í—ã–∑—ã–≤–∞–µ–º handleTelegramAuth —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ URL...');
                                                window.handleTelegramAuth(userData);
                                            }
                                        }
                                    } catch (e) {
                                        console.error('  - ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ URL iframe:', e);
                                    }
                                }
                                
                                lastCheckedUrl = newIframeUrl;
                            }
                        } catch (e) {
                            // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ CORS, –Ω–æ –ª–æ–≥–∏—Ä—É–µ–º –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
                            // console.log('  - ‚ö†Ô∏è CORS –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ URL iframe:', e.message);
                        }
                    }, 100); // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–µ 100ms –¥–ª—è –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
                    
                    // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —á–µ—Ä–µ–∑ 60 —Å–µ–∫—É–Ω–¥ (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
                    setTimeout(function() {
                        clearInterval(iframeUrlCheckInterval);
                        console.log('‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–∑–º–µ–Ω–µ–Ω–∏–π URL iframe');
                    }, 60000);
                }
                
                // –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π –Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ iframe –∏ —Å–∞–º–æ–º iframe
                const iframeContainer = widgetIframe.parentElement;
                
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
                if (iframeContainer) {
                    iframeContainer.addEventListener('click', function(e) {
                        console.log('üñ±Ô∏è ============================================');
                        console.log('üñ±Ô∏è –ö–õ–ò–ö –ù–ê –ö–û–ù–¢–ï–ô–ù–ï–†–ï IFRAME –í–ò–î–ñ–ï–¢–ê!');
                        console.log('üñ±Ô∏è ============================================');
                        console.log('  - –í—Ä–µ–º—è:', new Date().toISOString());
                        console.log('  - –¶–µ–ª—å –∫–ª–∏–∫–∞:', e.target);
                        console.log('  - –í–∏–¥–∂–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–¥–µ–ª–∞—Ç—å redirect –Ω–∞ /api/social-auth/telegram/auth/');
                        console.log('  - –ï—Å–ª–∏ redirect –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ BotFather');
                        
                        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–π URL iframe –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
                        const initialIframeUrl = widgetIframe.src;
                        console.log('  - –ù–∞—á–∞–ª—å–Ω—ã–π URL iframe:', initialIframeUrl);
                        
                        // –ù–∞—á–∏–Ω–∞–µ–º –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–∑–º–µ–Ω–µ–Ω–∏–π URL iframe
                        let checkCount = 0;
                        const maxChecks = 50; // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤ —Ç–µ—á–µ–Ω–∏–µ 5 —Å–µ–∫—É–Ω–¥ (50 * 100ms)
                        const urlCheckInterval = setInterval(function() {
                            checkCount++;
                            try {
                                const currentSrc = widgetIframe.src;
                                
                                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∏–∑–º–µ–Ω–∏–ª—Å—è –ª–∏ URL
                                if (currentSrc !== initialIframeUrl && currentSrc.includes('/api/social-auth/telegram/auth/')) {
                                    console.log('‚úÖ ============================================');
                                    console.log('‚úÖ REDIRECT –û–ë–ù–ê–†–£–ñ–ï–ù –í IFRAME –ü–û–°–õ–ï –ö–õ–ò–ö–ê!');
                                    console.log('‚úÖ ============================================');
                                    console.log('  - –ù–æ–≤—ã–π URL iframe:', currentSrc);
                                    
                                    // –ü—ã—Ç–∞–µ–º—Å—è –∏–∑–≤–ª–µ—á—å –¥–∞–Ω–Ω—ã–µ –∏–∑ URL
                                    try {
                                        const url = new URL(currentSrc);
                                        const params = new URLSearchParams(url.search);
                                        const userData = {};
                                        
                                        for (const [key, value] of params.entries()) {
                                            userData[key] = value;
                                        }
                                        
                                        if (userData.id) {
                                            console.log('  - ‚úÖ –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞–π–¥–µ–Ω—ã –≤ URL iframe!');
                                            console.log('  - user data:', userData);
                                            
                                            if (typeof window.handleTelegramAuth === 'function') {
                                                console.log('  - –í—ã–∑—ã–≤–∞–µ–º handleTelegramAuth —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ URL iframe...');
                                                window.handleTelegramAuth(userData);
                                } else {
                                                console.error('  - ‚ùå handleTelegramAuth –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!');
                                            }
                                        } else {
                                            console.log('  - ‚ö†Ô∏è URL —Å–æ–¥–µ—Ä–∂–∏—Ç endpoint, –Ω–æ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
                                            console.log('  - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã URL:', Object.fromEntries(params));
                                }
                            } catch (e) {
                                        console.error('  - ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ URL iframe:', e);
                                    }
                                    
                                    clearInterval(urlCheckInterval);
                                    return;
                                }
                                
                                // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
                                if (checkCount >= maxChecks) {
                                    clearInterval(urlCheckInterval);
                                    console.log('  - ‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π URL iframe (5 —Å–µ–∫—É–Ω–¥ –ø—Ä–æ—à–ª–æ)');
                                    console.log('  - ‚ùå Redirect –ù–ï –ø—Ä–æ–∏–∑–æ—à–µ–ª –≤ iframe!');
                                    console.log('  - –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:');
                                    console.log('    1. –î–æ–º–µ–Ω –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ BotFather –¥–ª—è –±–æ—Ç–∞ mr_proger_bot');
                                    console.log('    2. –ë—Ä–∞—É–∑–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç redirect –∏–∑ iframe');
                                    console.log('    3. –í–∏–¥–∂–µ—Ç –Ω–µ –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å redirect');
                                    console.log('    4. –í–∏–¥–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥—Ä—É–≥–æ–π –º–µ—Ç–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏');
                                }
                            } catch (e) {
                                console.error('  - –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å URL iframe (CORS):', e.message);
                            }
                        }, 100); // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–µ 100ms
                    }, true); // –ò—Å–ø–æ–ª—å–∑—É–µ–º capture phase –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –≤—Å–µ—Ö –∫–ª–∏–∫–æ–≤
                }
                
                // –¢–∞–∫–∂–µ –ø—Ä–æ–±—É–µ–º –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å –∫–ª–∏–∫ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –Ω–∞ iframe
                // (—Ö–æ—Ç—è –æ–±—ã—á–Ω–æ –∫–ª–∏–∫–∏ –Ω–∞ iframe –Ω–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç—Å—è –∏–∑-–∑–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
                widgetIframe.addEventListener('click', function(e) {
                    console.log('üñ±Ô∏è ============================================');
                    console.log('üñ±Ô∏è –ö–õ–ò–ö –ù–ê–ü–†–Ø–ú–£–Æ –ù–ê IFRAME –í–ò–î–ñ–ï–¢–ê!');
                    console.log('üñ±Ô∏è ============================================');
                    console.log('  - –í—Ä–µ–º—è:', new Date().toISOString());
                    console.log('  - –≠—Ç–æ —Å–æ–±—ã—Ç–∏–µ –º–æ–∂–µ—Ç –Ω–µ —Å—Ä–∞–±–æ—Ç–∞—Ç—å –∏–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ iframe');
                }, true);
                
                // –¢–∞–∫–∂–µ –ø—Ä–æ–±—É–µ–º –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å –∫–ª–∏–∫ –Ω–∞ —Å–∞–º–æ–º iframe
                widgetIframe.addEventListener('load', function() {
                    console.log('üì• ============================================');
                    console.log('üì• IFRAME –í–ò–î–ñ–ï–¢–ê –ó–ê–ì–†–£–ñ–ï–ù/–ü–ï–†–ï–ó–ê–ì–†–£–ñ–ï–ù!');
                    console.log('üì• ============================================');
                    console.log('  - URL iframe:', widgetIframe.src);
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏ URL –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                    if (widgetIframe.src.includes('/api/social-auth/telegram/auth/')) {
                        console.log('‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω redirect –Ω–∞ auth endpoint –≤ iframe!');
                        
                        // –ü—ã—Ç–∞–µ–º—Å—è –∏–∑–≤–ª–µ—á—å –¥–∞–Ω–Ω—ã–µ –∏–∑ URL
                        try {
                            const url = new URL(widgetIframe.src);
                            const params = new URLSearchParams(url.search);
                            const userData = {};
                            
                            for (const [key, value] of params.entries()) {
                                userData[key] = value;
                            }
                            
                            if (userData.id) {
                                console.log('‚úÖ –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞–π–¥–µ–Ω—ã –≤ URL iframe –ø–æ—Å–ª–µ redirect!');
                                console.log('  - user data:', userData);
                                
                                // –í—ã–∑—ã–≤–∞–µ–º handleTelegramAuth —Å –¥–∞–Ω–Ω—ã–º–∏
                                if (typeof window.handleTelegramAuth === 'function') {
                                    console.log('  - –í—ã–∑—ã–≤–∞–µ–º handleTelegramAuth —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ URL iframe...');
                                    window.handleTelegramAuth(userData);
                                } else {
                                    console.error('  - ‚ùå handleTelegramAuth –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!');
                                }
                            } else {
                                console.log('  - ‚ö†Ô∏è URL —Å–æ–¥–µ—Ä–∂–∏—Ç endpoint, –Ω–æ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
                                console.log('  - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã URL:', Object.fromEntries(params));
                            }
                        } catch (e) {
                            console.error('  - ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ URL iframe:', e);
                        }
                    } else if (widgetIframe.src.includes('return_to')) {
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏ URL return_to —Å –¥–∞–Ω–Ω—ã–º–∏
                        console.log('  - URL —Å–æ–¥–µ—Ä–∂–∏—Ç return_to, –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö...');
                        try {
                            const url = new URL(widgetIframe.src);
                            const params = new URLSearchParams(url.search);
                            
                            // –ï—Å–ª–∏ –µ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä return_to, –ø—Ä–æ–≤–µ—Ä—è–µ–º, —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏ –æ–Ω –¥–∞–Ω–Ω—ã–µ
                            const returnTo = params.get('return_to');
                            if (returnTo && returnTo.includes('/api/social-auth/telegram/auth/')) {
                                console.log('  - return_to —Å–æ–¥–µ—Ä–∂–∏—Ç auth endpoint!');
                                const returnUrl = new URL(returnTo);
                                const returnParams = new URLSearchParams(returnUrl.search);
                                
                                const userData = {};
                                for (const [key, value] of returnParams.entries()) {
                                    userData[key] = value;
                                }
                                
                                if (userData.id) {
                                    console.log('‚úÖ –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞–π–¥–µ–Ω—ã –≤ return_to –ø–∞—Ä–∞–º–µ—Ç—Ä–µ!');
                                    console.log('  - user data:', userData);
                                    
                                    if (typeof window.handleTelegramAuth === 'function') {
                                        window.handleTelegramAuth(userData);
                                    }
                                }
                            }
                        } catch (e) {
                            console.error('  - ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ return_to:', e);
                        }
                    }
                });
            }
        }, 3000);
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –Ω–æ–≤–æ–≥–æ API (window.Telegram.LoginWidget)
        if (window.Telegram && window.Telegram.LoginWidget) {
            console.log('‚úÖ –ù–æ–≤—ã–π API Telegram.LoginWidget –Ω–∞–π–¥–µ–Ω, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫');
            window.Telegram.LoginWidget.dataOnauth = handleTelegramAuth;
        }
        
        // –¢–∞–∫–∂–µ –¥–ª—è —Å—Ç–∞—Ä–æ–≥–æ API (–Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π)
    if (window.TelegramLoginWidget) {
            console.log('‚úÖ –°—Ç–∞—Ä—ã–π API TelegramLoginWidget –Ω–∞–π–¥–µ–Ω, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫');
        window.TelegramLoginWidget.dataOnauth = handleTelegramAuth;
    }
    
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —Ç–µ—Å—Ç–æ–≤–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
        const container = document.getElementById('telegram-mock-auth-container');
        if (container) {
            const isLocalhost = window.location.hostname === 'localhost' || 
                               window.location.hostname === '127.0.0.1' ||
                               window.location.hostname.includes('localhost');
            const urlParams = new URLSearchParams(window.location.search);
            const showMock = urlParams.has('show_mock');
            
            if (isLocalhost || showMock) {
                container.style.display = 'block';
            }
        }
    });
    
    // –¢–∞–∫–∂–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≤–∏–¥–∂–µ—Ç–∞ (–µ—Å–ª–∏ –æ–Ω –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)
    window.addEventListener('load', function() {
        setTimeout(function() {
            if (window.Telegram && window.Telegram.LoginWidget) {
                console.log('‚úÖ –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –Ω–æ–≤–æ–≥–æ API');
                window.Telegram.LoginWidget.dataOnauth = handleTelegramAuth;
            }
            if (window.TelegramLoginWidget) {
                console.log('‚úÖ –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Å—Ç–∞—Ä–æ–≥–æ API');
                window.TelegramLoginWidget.dataOnauth = handleTelegramAuth;
            }
        }, 1000);
    });
    
    // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ (–Ω–∞ —Å–ª—É—á–∞–π –µ—Å–ª–∏ –≤–∏–¥–∂–µ—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –æ—á–µ–Ω—å –ø–æ–∑–¥–Ω–æ)
    let checkCount = 0;
    const checkInterval = setInterval(function() {
        checkCount++;
        if (checkCount > 10) {
            clearInterval(checkInterval);
            return;
        }
        
        if (window.Telegram && window.Telegram.LoginWidget) {
            if (!window.Telegram.LoginWidget.dataOnauth || window.Telegram.LoginWidget.dataOnauth !== handleTelegramAuth) {
                console.log('‚úÖ –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –Ω–æ–≤–æ–≥–æ API');
                window.Telegram.LoginWidget.dataOnauth = handleTelegramAuth;
            }
        }
    }, 1000);
</script>

<style>
    /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —Ç–µ—Å—Ç–æ–≤–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ */
    .telegram-mock-auth-btn:hover {
        background: #f57c00 !important;
        transform: translateY(-1px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    
    .telegram-mock-auth-btn:active {
        transform: translateY(0);
    }
    
    #telegram-mock-auth-container {
        margin-top: 15px;
    }
</style>

{% block scripts %}{% endblock %}

<!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ JavaScript –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –æ—Ç—Å—Ç—É–ø–æ–≤ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ -->
<script src="{% static 'blog/js/header-spacing.js' %}" defer></script>

<!-- –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ —Å—é–¥–∞ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è render-blocking) -->
<script>
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç –≤–∏–¥–∂–µ—Ç–∞ Telegram
    window.addEventListener('message', function(event) {
        if (event.data && event.data.type === 'telegram-auth') {
            window.onTelegramAuth(event.data.user);
        }
    });
    
    // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
    window.onTelegramAuth = function(user) {
        console.log('Telegram auth called with:', user);
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º CSRF —Ç–æ–∫–µ–Ω
        const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]');
        if (!csrfToken) {
            console.error('CSRF token not found');
            alert('–û—à–∏–±–∫–∞: CSRF —Ç–æ–∫–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω');
            return;
        }
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
        fetch('/api/social-auth/telegram/auth/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': csrfToken.value,
            },
            body: JSON.stringify(user)
        })
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
            return response.json();
        })
        .then(data => {
            console.log('üì¶ Response data:', data);
            if (data.success) {
                console.log('‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º...');
                // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Ö–æ–¥–∞ –µ—Å–ª–∏ –æ–Ω–æ –æ—Ç–∫—Ä—ã—Ç–æ
                const loginModal = document.getElementById('login-modal');
                if (loginModal && loginModal.classList.contains('active')) {
                    loginModal.classList.remove('active');
                }
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                const notification = document.createElement('div');
                notification.className = 'message-notification success';
                notification.textContent = data.message || '–£—Å–ø–µ—à–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram!';
                document.body.appendChild(notification);
                // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–ª–∏ —É–∫–∞–∑–∞–Ω–Ω—ã–π URL
                setTimeout(() => {
                    if (data.redirect_url) {
                        window.location.href = data.redirect_url;
                    } else {
                        window.location.href = '/';
                    }
                }, 1000);
            } else {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:', data.error);
                alert(data.error || '–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏');
            }
        })
        .catch(error => {
            console.error('Network error:', error);
            alert('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message);
        });
    };
</script>

<!-- Cookie Consent Manager - –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–º —Ç–µ–≥–æ–º body -->
<script src="{% static 'blog/js/cookie-consent.js' %}"></script>

<!-- Highlight.js –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏ –∫–æ–¥–∞ -->
<script>
(function() {
    let attempts = 0;
    const maxAttempts = 50; // –ú–∞–∫—Å–∏–º—É–º 5 —Å–µ–∫—É–Ω–¥ –æ–∂–∏–¥–∞–Ω–∏—è
    
    function initHighlight() {
        attempts++;
        
        if (typeof hljs !== 'undefined' && typeof hljs.highlightAll === 'function') {
            console.log('‚úÖ Highlight.js –∑–∞–≥—Ä—É–∂–µ–Ω, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏ –∫–æ–¥–∞...');
            
            try {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º highlightAll –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Å–µ—Ö –±–ª–æ–∫–æ–≤
                hljs.highlightAll();
                
                // –¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –±–ª–æ–∫–æ–≤
                const codeBlocks = document.querySelectorAll('pre code.hljs, code[class*="language-"].hljs');
                console.log(`‚úÖ –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –∫ ${codeBlocks.length} –±–ª–æ–∫–∞–º –∫–æ–¥–∞`);
                
                if (codeBlocks.length === 0) {
                    // –ï—Å–ª–∏ highlightAll –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª, –ø—Ä–æ–±—É–µ–º –≤—Ä—É—á–Ω—É—é
                    const allCodeBlocks = document.querySelectorAll('pre code, code[class*="language-"]');
                    console.log(`–ù–∞–π–¥–µ–Ω–æ –±–ª–æ–∫–æ–≤ –∫–æ–¥–∞: ${allCodeBlocks.length}`);
                    
                    allCodeBlocks.forEach(function(block) {
                        if (!block.classList.contains('hljs')) {
                            try {
                                hljs.highlightElement(block);
                                console.log('‚úÖ –ë–ª–æ–∫ –∫–æ–¥–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω –≤—Ä—É—á–Ω—É—é:', block.className);
                            } catch (e) {
                                console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥—Å–≤–µ—Ç–∫–µ –±–ª–æ–∫–∞:', e);
                            }
                        }
                    });
                }
            } catch (e) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ highlightAll:', e);
                // Fallback: –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –±–ª–æ–∫–∏ –≤—Ä—É—á–Ω—É—é
                const codeBlocks = document.querySelectorAll('pre code, code[class*="language-"]');
                codeBlocks.forEach(function(block) {
                    if (!block.classList.contains('hljs')) {
                        try {
                            hljs.highlightElement(block);
                        } catch (err) {
                            console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥—Å–≤–µ—Ç–∫–µ –±–ª–æ–∫–∞:', err);
                        }
                    }
                });
            }
        } else if (typeof hljs !== 'undefined' && typeof hljs.highlightElement === 'function') {
            // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏–π highlight.js
            console.log('‚úÖ Highlight.js –∑–∞–≥—Ä—É–∂–µ–Ω (—Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è), –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏ –∫–æ–¥–∞...');
            const codeBlocks = document.querySelectorAll('pre code, code[class*="language-"]');
            codeBlocks.forEach(function(block) {
                if (!block.classList.contains('hljs')) {
                    try {
                        hljs.highlightElement(block);
                    } catch (e) {
                        console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥—Å–≤–µ—Ç–∫–µ –±–ª–æ–∫–∞:', e);
                    }
                }
            });
            console.log(`‚úÖ –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –∫ ${codeBlocks.length} –±–ª–æ–∫–∞–º –∫–æ–¥–∞`);
        } else {
            // –ï—Å–ª–∏ hljs –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω, –∂–¥–µ–º –Ω–µ–º–Ω–æ–≥–æ –∏ –ø—Ä–æ–±—É–µ–º —Å–Ω–æ–≤–∞
            if (attempts < maxAttempts) {
                setTimeout(initHighlight, 100);
            } else {
                console.warn('‚ö†Ô∏è Highlight.js –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è –ø–æ—Å–ª–µ', maxAttempts * 100, '–º—Å');
                console.warn('typeof hljs:', typeof hljs);
            }
        }
    }
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initHighlight);
    } else {
        // DOM —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω, –Ω–æ —Å–∫—Ä–∏–ø—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
        initHighlight();
    }
    
    // –¢–∞–∫–∂–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
    if (typeof MutationObserver !== 'undefined') {
        const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                if (mutation.addedNodes.length > 0 && typeof hljs !== 'undefined') {
                    mutation.addedNodes.forEach(function(node) {
                        if (node.nodeType === 1) { // Element node
                            const codeBlocks = node.querySelectorAll ? node.querySelectorAll('pre code') : [];
                            codeBlocks.forEach(function(block) {
                                if (!block.classList.contains('hljs')) {
                                    hljs.highlightElement(block);
                                }
                            });
                        }
                    });
                }
            });
        });
        
        observer.observe(document.body, {
            childList: true,
            subtree: true
        });
    }
})();
</script>

</body>
</html>