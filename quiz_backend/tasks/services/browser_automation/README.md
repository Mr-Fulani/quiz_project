# Browser Automation –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏

## –û–ø–∏—Å–∞–Ω–∏–µ

–ú–æ–¥—É–ª—å –±—Ä–∞—É–∑–µ—Ä–Ω–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –≤ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –ø—É–±–ª–∏—á–Ω–æ–≥–æ API –∏–ª–∏ —Ç—Ä–µ–±—É—é—Ç —Å–ª–æ–∂–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

- **Instagram Reels** (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç) - —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∫—Ä–æ—Å—Å–ø–æ—Å—Ç–∏–Ω–≥–æ–º –≤ Facebook
- **Instagram Stories** - —á–µ—Ä–µ–∑ –æ–ø—Ü–∏—é "–í–∞—à–∞ –∏—Å—Ç–æ—Ä–∏—è"
- **Facebook Reels** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ Instagram Reels (–µ—Å–ª–∏ –∞–∫–∫–∞—É–Ω—Ç—ã —Å–≤—è–∑–∞–Ω—ã)
- **Facebook Stories** - —á–µ—Ä–µ–∑ –∫—Ä–æ—Å—Å–ø–æ—Å—Ç–∏–Ω–≥ –∏–∑ Instagram
- **TikTok** (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
- **YouTube Shorts** (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
- **Twitter/X** (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **BaseBrowserAutomation** - –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–Ω–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
2. **PlaywrightAutomation** - —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Playwright (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
3. **SeleniumAutomation** - —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Selenium (fallback)
4. **BrowserSessionManager** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏ –±—Ä–∞—É–∑–µ—Ä–∞
5. **InstagramReelsAutomation** - –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ Instagram Reels

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
browser_automation/
‚îú‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ base_browser.py          # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å
‚îú‚îÄ‚îÄ playwright_service.py    # Playwright —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ selenium_service.py      # Selenium —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ session_manager.py       # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏
‚îî‚îÄ‚îÄ platforms/
    ‚îú‚îÄ‚îÄ __init__.py
    ‚îî‚îÄ‚îÄ instagram_reels.py   # Instagram Reels –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ credentials

1. –°–æ–∑–¥–∞–π—Ç–µ `SocialMediaCredentials` –¥–ª—è Instagram —á–µ—Ä–µ–∑ Django Admin
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `browser_type` ('playwright' –∏–ª–∏ 'selenium')
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `headless_mode` (True –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞, False –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)

### –ü—É–±–ª–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ –∫–æ–¥

```python
from tasks.services.social_media_service import publish_to_platform
from tasks.models import Task, TaskTranslation

task = Task.objects.get(id=123)
translation = task.translations.first()

# –ü—É–±–ª–∏–∫–∞—Ü–∏—è –≤ Instagram Reels —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∫—Ä–æ—Å—Å–ø–æ—Å—Ç–∏–Ω–≥–æ–º
result = publish_to_platform(task, translation, 'instagram_reels')
```

### –ü—É–±–ª–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É

1. –í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–¥–∞—á–∏ –≤ Django Admin
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ "üé• –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤ Instagram Reels"
3. –ò–ª–∏ "üöÄ –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å Reels —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Ä–µ–ø–æ—Å—Ç–æ–º" –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –∫—Ä–æ—Å—Å–ø–æ—Å—Ç–∏–Ω–≥–∞

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ Instagram Reels

### –ö—Ä–æ—Å—Å–ø–æ—Å—Ç–∏–Ω–≥ –≤ Facebook

–ü—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ Instagram Reels –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å–≤—è–∑—å –∞–∫–∫–∞—É–Ω—Ç–æ–≤ Instagram-Facebook
- –í–∫–ª—é—á–∞–µ—Ç—Å—è —á–µ–∫–±–æ–∫—Å "–¢–∞–∫–∂–µ –¥–µ–ª–∏—Ç—å—Å—è –≤ Facebook" (–µ—Å–ª–∏ –∞–∫–∫–∞—É–Ω—Ç—ã —Å–≤—è–∑–∞–Ω—ã)
- Reels –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –≤ Facebook Reels

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ Stories

- –í–∫–ª—é—á–∞–µ—Ç—Å—è –æ–ø—Ü–∏—è "–í–∞—à–∞ –∏—Å—Ç–æ—Ä–∏—è"
- Reels –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ Instagram Stories

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏

–°–µ—Å—Å–∏–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `SocialMediaCredentials.extra_data['browser_session']`:
- Cookies —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –°–µ—Å—Å–∏–∏ –≤–∞–ª–∏–¥–Ω—ã 7 –¥–Ω–µ–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–µ–∫—à–∏—Ö —Å–µ—Å—Å–∏–π

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- `playwright==1.40.0` - –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- `selenium==4.15.0` - fallback –≤–∞—Ä–∏–∞–Ω—Ç
- `undetected-chromedriver==3.5.4` - –¥–ª—è –æ–±—Ö–æ–¥–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Playwright –±—Ä–∞—É–∑–µ—Ä–æ–≤

```bash
playwright install chromium
playwright install firefox
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∏

–í `settings.py`:

```python
BROWSER_AUTOMATION_ENABLED = True  # –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –±—Ä–∞—É–∑–µ—Ä–Ω—É—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é
BROWSER_HEADLESS = True  # Headless —Ä–µ–∂–∏–º
BROWSER_TIMEOUT = 60  # –¢–∞–π–º–∞—É—Ç –æ–ø–µ—Ä–∞—Ü–∏–π –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
BROWSER_RETRY_COUNT = 3  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
```

## –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### –°–≤—è–∑—å –∞–∫–∫–∞—É–Ω—Ç–æ–≤ Instagram-Facebook

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫—Ä–æ—Å—Å–ø–æ—Å—Ç–∏–Ω–≥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:
1. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å Instagram –∞–∫–∫–∞—É–Ω—Ç –≤ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ñ–∏–ª—å
2. –°–≤—è–∑–∞—Ç—å Instagram —Å Facebook —Å—Ç—Ä–∞–Ω–∏—Ü–µ–π —á–µ—Ä–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Instagram
3. –ü–æ—Å–ª–µ —Å–≤—è–∑–∏ —á–µ–∫–±–æ–∫—Å "–¢–∞–∫–∂–µ –¥–µ–ª–∏—Ç—å—Å—è –≤ Facebook" –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ headless —Ä–µ–∂–∏–º –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
- –•—Ä–∞–Ω–∏—Ç–µ credentials –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ
- –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ —Å–µ—Å—Å–∏–∏
- –°–æ–±–ª—é–¥–∞–π—Ç–µ rate limits –ø–ª–∞—Ç—Ñ–æ—Ä–º

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –ø—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤ `SocialMediaPost.error_message`
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –≤ `platforms/` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `tiktok.py`)
2. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –∫–ª–∞—Å—Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏, –Ω–∞—Å–ª–µ–¥—É—è –æ—Ç `BaseBrowserAutomation`
3. –î–æ–±–∞–≤—å—Ç–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –≤ `BROWSER_PLATFORMS` –≤ `social_media_service.py`
4. –î–æ–±–∞–≤—å—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –≤ –∞–¥–º–∏–Ω–∫—É

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```python
from tasks.services.browser_automation.platforms.instagram_reels import InstagramReelsAutomation
from webhooks.models import SocialMediaCredentials

creds = SocialMediaCredentials.objects.get(platform='instagram')
automation = InstagramReelsAutomation(creds)

result = automation.publish_reels(
    video_url='https://example.com/video.mp4',
    caption='Test caption',
    share_to_facebook=True,
    add_to_story=True
)
```


