#!/bin/bash

echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
echo "üîç –°–†–ê–í–ù–ï–ù–ò–ï CSS –§–ê–ô–õ–û–í –ú–ï–ñ–î–£ –õ–û–ö–ê–õ–¨–ù–´–ú –ò –ü–†–û–î–ê–ö–®–ï–ù –û–ö–†–£–ñ–ï–ù–ò–Ø–ú–ò"
echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"

echo ""
echo "üìã 1. –ü–û–õ–£–ß–ï–ù–ò–ï CSS –§–ê–ô–õ–û–í –ò–ó –ü–†–û–î–ê–ö–®–ï–ù–ê:"
echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"

# –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Ñ–∞–π–ª–æ–≤
mkdir -p /tmp/prod_styles

# –ü–æ–ª—É—á–∞–µ–º CSS —Ñ–∞–π–ª—ã –∏–∑ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
echo "üì• –ö–æ–ø–∏—Ä—É–µ–º CSS —Ñ–∞–π–ª—ã –∏–∑ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞..."
docker compose -f docker-compose.local-prod.yml exec -T quiz_backend find staticfiles -name "*.css" | head -10 | while read css_file; do
    if [ -n "$css_file" ]; then
        echo "üìÑ –ö–æ–ø–∏—Ä—É–µ–º: $css_file"
        docker compose -f docker-compose.local-prod.yml exec -T quiz_backend cat "$css_file" > "/tmp/prod_styles/$(basename "$css_file")"
    fi
done

echo ""
echo "üìã 2. –ü–û–õ–£–ß–ï–ù–ò–ï CSS –§–ê–ô–õ–û–í –ò–ó –õ–û–ö–ê–õ–¨–ù–û–ì–û –û–ö–†–£–ñ–ï–ù–ò–Ø:"
echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"

# –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
mkdir -p /tmp/local_styles

# –ü–æ–ª—É—á–∞–µ–º CSS —Ñ–∞–π–ª—ã –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
echo "üì• –ö–æ–ø–∏—Ä—É–µ–º CSS —Ñ–∞–π–ª—ã –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞..."
docker compose exec -T quiz_backend find staticfiles -name "*.css" | head -10 | while read css_file; do
    if [ -n "$css_file" ]; then
        echo "üìÑ –ö–æ–ø–∏—Ä—É–µ–º: $css_file"
        docker compose exec -T quiz_backend cat "$css_file" > "/tmp/local_styles/$(basename "$css_file")"
    fi
done

echo ""
echo "üìã 3. –°–†–ê–í–ù–ï–ù–ò–ï –§–ê–ô–õ–û–í:"
echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"

# –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ñ–∞–π–ª—ã
echo "üîç –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ:"
ls -la /tmp/prod_styles/ 2>/dev/null || echo "‚ùå –ù–µ—Ç —Ñ–∞–π–ª–æ–≤ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ"

echo ""
echo "üîç –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏:"
ls -la /tmp/local_styles/ 2>/dev/null || echo "‚ùå –ù–µ—Ç —Ñ–∞–π–ª–æ–≤ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏"

echo ""
echo "üìã 4. –î–ï–¢–ê–õ–¨–ù–û–ï –°–†–ê–í–ù–ï–ù–ò–ï:"
echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"

# –ù–∞—Ö–æ–¥–∏–º –æ–±—â–∏–µ —Ñ–∞–π–ª—ã –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
for file in /tmp/prod_styles/*; do
    if [ -f "$file" ]; then
        filename=$(basename "$file")
        local_file="/tmp/local_styles/$filename"
        
        if [ -f "$local_file" ]; then
            echo "üîç –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º: $filename"
            if diff "$file" "$local_file" > /dev/null 2>&1; then
                echo "‚úÖ –§–∞–π–ª—ã –∏–¥–µ–Ω—Ç–∏—á–Ω—ã: $filename"
            else
                echo "‚ùå –§–∞–π–ª—ã –†–ê–ó–õ–ò–ß–ê–Æ–¢–°–Ø: $filename"
                echo "üìä –†–∞–∑–º–µ—Ä—ã:"
                echo "   –ü—Ä–æ–¥–∞–∫—à–µ–Ω: $(wc -c < "$file") –±–∞–π—Ç"
                echo "   –õ–æ–∫–∞–ª—å–Ω—ã–π:  $(wc -c < "$local_file") –±–∞–π—Ç"
                echo "üìù –ü–µ—Ä–≤—ã–µ —Ä–∞–∑–ª–∏—á–∏—è:"
                diff "$file" "$local_file" | head -10
                echo ""
            fi
        else
            echo "‚ö†Ô∏è  –§–∞–π–ª –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏: $filename"
        fi
    fi
done

echo ""
echo "üìã 5. –ü–†–û–í–ï–†–ö–ê –ò–°–•–û–î–ù–´–• CSS –§–ê–ô–õ–û–í:"
echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"

echo "üîç –ò—â–µ–º –∏—Å—Ö–æ–¥–Ω—ã–µ CSS —Ñ–∞–π–ª—ã –≤ –ø—Ä–æ–µ–∫—Ç–µ:"
find quiz_backend -name "*.css" -type f | head -10

echo ""
echo "üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏—Å—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤:"
for css_file in $(find quiz_backend -name "*.css" -type f | head -5); do
    if [ -f "$css_file" ]; then
        echo "üìÑ –§–∞–π–ª: $css_file"
        echo "üìä –†–∞–∑–º–µ—Ä: $(wc -c < "$css_file") –±–∞–π—Ç"
        echo "üìù –ü–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫:"
        head -5 "$css_file"
        echo ""
    fi
done

echo ""
echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
echo "üßπ –û–ß–ò–°–¢–ö–ê –í–†–ï–ú–ï–ù–ù–´–• –§–ê–ô–õ–û–í:"
echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"

rm -rf /tmp/prod_styles /tmp/local_styles
echo "‚úÖ –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —É–¥–∞–ª–µ–Ω—ã"

echo ""
echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
echo "üéØ –í–´–í–û–î–´:"
echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
echo ""
echo "1. –ï—Å–ª–∏ —Ñ–∞–π–ª—ã –∏–¥–µ–Ω—Ç–∏—á–Ω—ã - –ø—Ä–æ–±–ª–µ–º–∞ –≤ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–∏ –±—Ä–∞—É–∑–µ—Ä–∞"
echo "2. –ï—Å–ª–∏ —Ñ–∞–π–ª—ã —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è - –ø—Ä–æ–±–ª–µ–º–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–±–æ—Ä–∫–∏"
echo "3. –ï—Å–ª–∏ —Ñ–∞–π–ª—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç - –ø—Ä–æ–±–ª–µ–º–∞ –≤ collectstatic"
echo "4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏—Å—Ö–æ–¥–Ω—ã–µ CSS —Ñ–∞–π–ª—ã –≤ quiz_backend/"
echo ""
echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
