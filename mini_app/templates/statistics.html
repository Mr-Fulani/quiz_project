{% extends "base.html" %}

{% block title %}
{{ translations.get('statistics_title', '–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞') }}
{% endblock %}

{% block extra_css %}
<!-- CSS –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ base.html –ø—Ä–∏ SPA-–Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
{% if not request.headers.get('X-Requested-With') %}
<link rel="stylesheet" href="{{ get_css_url('statistics.css') }}">
{% endif %}
{% endblock %}

{% block content %}
<div class="statistics-container">
    <h1 data-translate="statistics_title">{{ translations.get('statistics_title', '–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞') }}</h1>
    
    {% if user_statistics and user_statistics.stats %}
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon">üìä</div>
            <div class="stat-number">{{ user_statistics.stats.total_quizzes or 0 }}</div>
            <div class="stat-label" data-translate="total_questions">{{ translations.get('total_questions', '–í—Å–µ–≥–æ –≤–æ–ø—Ä–æ—Å–æ–≤') }}</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">‚úÖ</div>
            <div class="stat-number">{{ user_statistics.stats.completed_quizzes or 0 }}</div>
            <div class="stat-label" data-translate="correct_answers">{{ translations.get('correct_answers', '–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤') }}</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">‚ùå</div>
            <div class="stat-number">{{ user_statistics.stats.failed_quizzes or 0 }}</div>
            <div class="stat-label" data-translate="incorrect_answers">{{ translations.get('incorrect_answers', '–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤') }}</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">üéØ</div>
            <div class="stat-number">{{ user_statistics.stats.success_rate or 0 }}%</div>
            <div class="stat-label" data-translate="accuracy">{{ translations.get('accuracy', '–¢–æ—á–Ω–æ—Å—Ç—å') }}</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">üî•</div>
            <div class="stat-number">{{ user_statistics.stats.current_streak or 0 }}</div>
            <div class="stat-label" data-translate="streak">{{ translations.get('streak', '–¢–µ–∫—É—â–∞—è —Å–µ—Ä–∏—è') }}</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">üèÜ</div>
            <div class="stat-number">{{ user_statistics.stats.best_streak or 0 }}</div>
            <div class="stat-label" data-translate="best_streak">{{ translations.get('best_streak', '–õ—É—á—à–∞—è —Å–µ—Ä–∏—è') }}</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">üíé</div>
            <div class="stat-number">{{ user_statistics.stats.total_points or 0 }}</div>
            <div class="stat-label" data-translate="total_points">{{ translations.get('total_points', '–í—Å–µ–≥–æ –æ—á–∫–æ–≤') }}</div>
        </div>
    </div>
    
    <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ —Ç–µ–º–∞–º -->
    {% if user_statistics.topic_progress %}
    <div class="topic-progress-section">
        <h2 data-translate="topic_progress_title">{{ translations.get('topic_progress_title', '–ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ —Ç–µ–º–∞–º') }}</h2>
        <div class="topic-progress-list">
            {% for topic in user_statistics.topic_progress %}
            <div class="topic-progress-item">
                <div class="topic-name">{{ topic.name }}</div>
                <div class="topic-progress-bar">
                    <div class="topic-progress-fill" style="width: {{ topic.percentage }}%"></div>
                    <span class="topic-progress-text">{{ topic.completed }}/{{ topic.total }} ({{ topic.percentage }}%)</span>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
    
    <!-- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è -->
    {% if user_statistics.achievements %}
    <div class="achievements-section">
        <h2 data-translate="achievements_title">{{ translations.get('achievements_title', '–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è') }}</h2>
        <div class="achievements-grid">
            {% for achievement in user_statistics.achievements %}
            <div class="achievement-card {% if achievement.unlocked %}unlocked{% else %}locked{% endif %}">
                <div class="achievement-icon">{{ achievement.icon }}</div>
                <div class="achievement-name" data-achievement-id="{{ achievement.id }}">{{ achievement.name }}</div>
                {% if achievement.unlocked %}
                <div class="achievement-status">‚úì</div>
                {% else %}
                <div class="achievement-status">üîí</div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
    
    {% else %}
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon">üìä</div>
            <div class="stat-number">0</div>
            <div class="stat-label" data-translate="total_questions">{{ translations.get('total_questions', '–í—Å–µ–≥–æ –≤–æ–ø—Ä–æ—Å–æ–≤') }}</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">‚úÖ</div>
            <div class="stat-number">0</div>
            <div class="stat-label" data-translate="correct_answers">{{ translations.get('correct_answers', '–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤') }}</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">‚ùå</div>
            <div class="stat-number">0</div>
            <div class="stat-label" data-translate="incorrect_answers">{{ translations.get('incorrect_answers', '–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤') }}</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">üéØ</div>
            <div class="stat-number">0%</div>
            <div class="stat-label" data-translate="accuracy">{{ translations.get('accuracy', '–¢–æ—á–Ω–æ—Å—Ç—å') }}</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">üî•</div>
            <div class="stat-number">0</div>
            <div class="stat-label" data-translate="streak">{{ translations.get('streak', '–¢–µ–∫—É—â–∞—è —Å–µ—Ä–∏—è') }}</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">üèÜ</div>
            <div class="stat-number">0</div>
            <div class="stat-label" data-translate="best_streak">{{ translations.get('best_streak', '–õ—É—á—à–∞—è —Å–µ—Ä–∏—è') }}</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">üíé</div>
            <div class="stat-number">0</div>
            <div class="stat-label" data-translate="total_points">{{ translations.get('total_points', '–í—Å–µ–≥–æ –æ—á–∫–æ–≤') }}</div>
        </div>
    </div>
    
    <div class="empty-state-container">
        <div class="empty-icon">üìä</div>
        <p data-translate="no_statistics_data">{{ translations.get('no_statistics_data', '–ü–æ–∫–∞ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è') }}</p>
        <p class="empty-hint">{{ translations.get('start_solving', '–ù–∞—á–Ω–∏—Ç–µ —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞—á–∏, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É') }}</p>
    </div>
    {% endif %}
</div>
{% endblock %}

{% block extra_js %}
<!-- JS –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ base.html –ø—Ä–∏ SPA-–Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
{% if not request.headers.get('X-Requested-With') %}
<script src="{{ statistics_js_url }}"></script>
{% endif %}
{% endblock %}