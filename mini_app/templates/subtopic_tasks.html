{% extends "base.html" %}

{% block title %}{{ subtopic.name }} - {{ translations.get('tasks', 'Задачи') }}{% endblock %}

{% block extra_css %}
{% endblock %}

{% block content %}
<div class="container" id="tasks-root" data-subtopic-id="{{ subtopic.id }}" data-topic-id="{{ topic.id if topic else '' }}" data-language="{{ current_language }}">
    <header class="page-header">
        <div class="back-button" onclick="goBackFromTasks()">
            <i class="fas fa-arrow-left"></i>
            <span>{{ translations.get('back_button', 'Назад') }}</span>
        </div>
        <h1>{{ subtopic.name }}</h1>
    </header>

    <div class="tasks-container">
        {% if tasks %}
            {% for task in tasks %}
            <div class="task-item" data-task-id="{{ task.id }}" data-solved="{{ task.is_solved | lower }}">
                <!-- Картинка задачи -->
                {% if task.image_url %}
                <div class="task-image">
                    <img src="{{ task.image_url }}" alt="{{ translations.get('task_image', 'Изображение задачи') }}" loading="lazy">
                </div>
                {% endif %}

                <!-- Варианты ответов -->
                <div class="task-answers">
                    {% for answer in task.answers %}
                    <button class="answer-option" 
                            data-answer="{{ answer }}"
                            data-correct="{% if answer == task.correct_answer %}true{% else %}false{% endif %}"
                            data-explanation="{{ task.explanation }}">
                        {{ answer }}
                    </button>
                    {% endfor %}
                </div>

                <!-- Объяснение (скрыто по умолчанию) -->
                <div class="task-explanation" id="explanation-{{ task.id }}" style="display: none;">
                    <div class="explanation-content">
                        <h4>{{ translations.get('explanation', 'Объяснение') }}</h4>
                        <p>{{ task.explanation }}</p>
                    </div>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="no-tasks">
                <p>{{ translations.get('no_tasks_available', 'Задачи не найдены') }}</p>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %} 