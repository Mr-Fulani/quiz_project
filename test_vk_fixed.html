<!DOCTYPE html>
<html>
<head>
    <title>Test VK Share Fixed</title>
</head>
<body>
    <h1>Test VK Share - Fixed Version</h1>
    <p>Testing VK sharing with production domain instead of ngrok</p>
    
    <button onclick="testVKLocal()">Test VK (Local)</button>
    <button onclick="testVKProduction()">Test VK (Production)</button>
    <button onclick="testVKNgrok()">Test VK (Ngrok)</button>
    
    <script>
        function testVKLocal() {
            const url = 'http://localhost:8001/ru/post/krutoj-promt/';
            const vkUrl = generateVKUrl(url);
            console.log('Local URL:', url);
            console.log('VK URL:', vkUrl);
            window.open(vkUrl, '_blank', 'width=600,height=400');
        }
        
        function testVKProduction() {
            const url = 'https://quiz-code.com/ru/post/krutoj-promt/';
            const vkUrl = generateVKUrl(url);
            console.log('Production URL:', url);
            console.log('VK URL:', vkUrl);
            window.open(vkUrl, '_blank', 'width=600,height=400');
        }
        
        function testVKNgrok() {
            const url = 'https://0196d6086733.ngrok-free.app/ru/post/krutoj-promt/';
            const vkUrl = generateVKUrl(url);
            console.log('Ngrok URL:', url);
            console.log('VK URL:', vkUrl);
            window.open(vkUrl, '_blank', 'width=600,height=400');
        }
        
        function generateVKUrl(url) {
            // Для VK используем production домен вместо ngrok
            let vkUrl = url;
            if (url.includes('ngrok-free.app') || url.includes('localhost')) {
                // Заменяем ngrok/localhost на production домен для VK
                vkUrl = url.replace(/https?:\/\/[^\/]+/, 'https://quiz-code.com');
            }
            
            // Убираем языковой префикс для VK
            vkUrl = vkUrl.replace('/ru/', '/').replace('/en/', '/');
            
            return `https://vk.com/share.php?url=${encodeURIComponent(vkUrl)}`;
        }
    </script>
</body>
</html> 